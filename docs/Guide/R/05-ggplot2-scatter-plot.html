<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans" xml:lang="zh-Hans"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Simonzhou">
<title>05-ggplot2 绘图——散点图 – Medical Statistics Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Guide/Python/2025-02-20-Medical-expenses.html" rel="next">
<link href="../../Guide/R/04-ggplot2-folded-line.html" rel="prev">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-471db41ce322a552900897f16bd8eadd.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-39599dd41c217de25ded3edcfc388f1c.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交",
    "search-label": "搜索"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-G2HZEXHNCE"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-G2HZEXHNCE', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<meta property="og:title" content="05-ggplot2 绘图——散点图 – Medical Statistics Notes">
<meta property="og:description" content="This is a Note site.">
<meta property="og:image" content="www.lazyzhou.cn/Guide/R/images/logo.png">
<meta property="og:site_name" content="Medical Statistics Notes">
<meta name="twitter:title" content="05-ggplot2 绘图——散点图 – Medical Statistics Notes">
<meta name="twitter:description" content="This is a Note site.">
<meta name="twitter:image" content="www.lazyzhou.cn/Guide/R/05-ggplot2-scatter-plot_files/figure-html/fig5-1-1.png">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">医学统计学习笔记</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="搜索"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="展开或折叠导航栏" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link active" href="../../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-learn" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Learn</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-learn">
<li>
    <a class="dropdown-item" href="../../Learn/Basic/00-basic.html">
 <span class="dropdown-text">Basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Learn/Advance/00-advance.html">
 <span class="dropdown-text">Advance</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Learn/Bayes/00-About-Bayes.html">
 <span class="dropdown-text">Bayes</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-guide" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Guide</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-guide">
<li>
    <a class="dropdown-item" href="../../Guide/Guide-intro.html">
 <span class="dropdown-text">Guide</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Guide/Python/Python-intro.html">
 <span class="dropdown-text">Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Guide/R/01-R-intro.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Guide/SAS/25-02-16-SAS-intro.html">
 <span class="dropdown-text">SAS</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Guide/Stata/25-03-09-Stata-intro.html">
 <span class="dropdown-text">Stata</span></a>
  </li>  
    </ul>
</li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-quarto" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Quarto</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-quarto">
<li>
    <a class="dropdown-item" href="../../Quarto/quarto-intro.html">
 <span class="dropdown-text">Intro</span></a>
  </li>  
    </ul>
</li>
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-books" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Books</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-books">
<li>
    <a class="dropdown-item" href="../../navbar/small_talk/book.html">
 <span class="dropdown-text">Small Talk</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../navbar/translation/medicine.html">
 <span class="dropdown-text">Translation</span></a>
  </li>  
    </ul>
</li>
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://github.com/pumc-zhou" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="切换深色模式"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="切换阅读器模式">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="展开或折叠侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Guide</li><li class="breadcrumb-item"><a href="../../Guide/R/00-R-install.html">R</a></li><li class="breadcrumb-item"><a href="../../Guide/R/05-ggplot2-scatter-plot.html">05-ggplot2 绘图——散点图</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="展开或折叠侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="搜索" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="搜索"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">主页</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Learn</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Basic</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/00-basic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">医学统计学基础</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/01-preview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">关于卫生统计学</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/02-descriptive-statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">不同资料的统计描述</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/03-Random-events-probabilities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">随机事件的概率</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/04-discrete-type-random-variable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">离散型随机变量的概率分布</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/05-random-variable-of-continuous-type.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">连续型随机变量的概率分布</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/06-parameter-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参数估计</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/07-parameter-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参数检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/08-anova-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">方差分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/09-chi2-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">卡方检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/10-non-parameter-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">非参数检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Basic/11-regression-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">简单线性相关和回归</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Advance</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Advance/00-advance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00-医学统计学（伪）高级部分</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Advance/01-negative-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-负二项分布</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Bayes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Bayes/00-About-Bayes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">贝叶斯与概率推理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Learn/Bayes/01-Bayes-PGM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">贝叶斯与概率图模型（PGM）</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Guide</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/R/00-R-install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00-R 安装</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/R/01-R-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-R 相关介绍与记录</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/R/02-ggplot2-base.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-ggplot2 绘图基础</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/R/03-ggplot2-barplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-ggplot2 绘图——条形图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/R/04-ggplot2-folded-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04-ggplot2 绘图——折线图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/R/05-ggplot2-scatter-plot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">05-ggplot2 绘图——散点图</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Python/2025-02-20-Medical-expenses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">用Python和Stata处理一份卫生费用数据</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Python/25-03-09-cos-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">用Python做生存分析和COX回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Python/25-03-14-Sankey-diagram.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">用Python做桑基图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Python/25-04-28-DID.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DID 双重差分模型</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Python/25-04-28-DID-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Use the DID in Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Python/Python-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Python</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">SAS</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-02-16-SAS-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00-SAS-Intro and Record</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-03-11-SAS-install.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-SAS 安装与vscode 扩展</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-05-SAS-install-connect.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-SAS 在 Jupyter Notebook 中使用</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-22-SAS-Base.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-SAS Base</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-24-SAS-program.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04-SAS 程序基础</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-25-SAS-DATA-LIB.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05-SAS 数据库与数据集</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-26-SAS-DATA-tidy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06-SAS 数据集的整理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-28-SAS-function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07-SAS 运算符与常用函数</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-29-SAS-function-example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08-SAS 运算符与常用函数示例</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-29-SAS-univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09-SAS 计量资料的单变量分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-05-31-two-sample-univariate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10-SAS 两样本均数的比较分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-01-multi-sample-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-SAS 多个样本均数比较的方差分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-04-SAS-corr-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12-SAS 相关与回归分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-06-chi2-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13-SAS 卡方检验1-四格表资料卡方检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-06-chi2-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14-SAS 卡方检验2-四格表资料卡方检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-07-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15-SAS 对二项分布的概率计算与假设检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-08-poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16-SAS 对泊松分布的概率计算与假设检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-09-negative-binomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17-SAS 与负二项分布</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-10-Goodness-of-Fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18-SAS 拟合优度检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/SAS/25-06-10-poisson-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19-SAS Poisson 回归与负二项回归</span></a>
  </div>
</li>
      </ul>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Stata</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-03-09-Stata-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00-Stata Intro and Record</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-03-11-ITSA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-Stata 做 ITSA 分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-04-29-Stata-PY.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-Use Stata in Quarto(ipynb)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-02-stata-obs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-数据的初步观测</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-03-describe-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-统计描述指标</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-04-CI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04-置信区间（CI）</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-05-log-do.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06-代码的可复现性与文件管理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-05-scatter-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05-双变量作图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-05-ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07-t检验（t-test）</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-06-chi2-fisher-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08-卡方检验与Fisher精确检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-06-RR-CAL.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09-RR值与OR值的计算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-07-1-ANOVA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10-单因素方差分析（ANOVA）</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-07-2-simple-line-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-简单线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-07-3-multi-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12-多元线性回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-07-4-log-binary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13-二分类Logistic回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-08-1-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14-广义线性模型（GLM）</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-08-2-survival-ana.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15-生存分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-08-3-Cox-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16-Cox回归与比例风险假定检验</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-08-4-GEE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17-广义估计方程(GEE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-08-5-Ord-Logistic-Reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">18-有序多分类Logistic回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-09-1-multinomail-logistic-reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">19-无序多分类Logistic回归</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-09-2-data-manage.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">20-数据清洗与整理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-10-advanced-plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">21-复杂与精准绘图</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-10-coefplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">22-coefplot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-11-1-empirical-ana.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">23-Empericial Analysis Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Guide/Stata/25-05-11-2-DID.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">24-双重差分(DID)</span></a>
  </div>
</li>
      </ul>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Quarto</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Quarto/config-giscus-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Qmd config giscus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Quarto/quarto-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Quarto/quarto-LaTeX.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto与LaTeX的记录</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1"><h2 id="toc-title">该页面内容</h2>
   
  <ul>
<li>
<a href="#%E6%95%A3%E7%82%B9%E5%9B%BE" id="toc-散点图" class="nav-link active" data-scroll-target="#%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="header-section-number">1</span> 散点图</a>
  <ul class="collapse">
<li><a href="#%E7%BB%98%E5%88%B6%E5%9F%BA%E6%9C%AC%E6%95%A3%E7%82%B9%E5%9B%BE" id="toc-绘制基本散点图" class="nav-link" data-scroll-target="#%E7%BB%98%E5%88%B6%E5%9F%BA%E6%9C%AC%E6%95%A3%E7%82%B9%E5%9B%BE"><span class="header-section-number">1.1</span> 绘制基本散点图</a></li>
  <li><a href="#%E4%BD%BF%E7%94%A8%E7%82%B9%E5%BD%A2%E6%88%96%E9%A2%9C%E8%89%B2%E5%B1%9E%E6%80%A7%E5%AF%B9%E6%95%B0%E6%8D%AE%E7%82%B9%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84" id="toc-使用点形或颜色属性对数据点进行分组" class="nav-link" data-scroll-target="#%E4%BD%BF%E7%94%A8%E7%82%B9%E5%BD%A2%E6%88%96%E9%A2%9C%E8%89%B2%E5%B1%9E%E6%80%A7%E5%AF%B9%E6%95%B0%E6%8D%AE%E7%82%B9%E8%BF%9B%E8%A1%8C%E5%88%86%E7%BB%84"><span class="header-section-number">1.2</span> 使用点形或颜色属性对数据点进行分组</a></li>
  <li><a href="#%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E4%BA%8E%E9%BB%98%E8%AE%A4%E8%AE%BE%E7%BD%AE%E7%9A%84%E7%82%B9%E5%BD%A2" id="toc-使用不同于默认设置的点形" class="nav-link" data-scroll-target="#%E4%BD%BF%E7%94%A8%E4%B8%8D%E5%90%8C%E4%BA%8E%E9%BB%98%E8%AE%A4%E8%AE%BE%E7%BD%AE%E7%9A%84%E7%82%B9%E5%BD%A2"><span class="header-section-number">1.3</span> 使用不同于默认设置的点形</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/pumc-zhou/Med-Stat-Notes/blob/main/Guide/R/05-ggplot2-scatter-plot.qmd" class="toc-action"><i class="bi bi-github"></i>查看代码</a></li><li><a href="https://github.com/pumc-zhou/Med-Stat-Notes/issues/new" class="toc-action"><i class="bi empty"></i>反馈问题</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Guide</li><li class="breadcrumb-item"><a href="../../Guide/R/00-R-install.html">R</a></li><li class="breadcrumb-item"><a href="../../Guide/R/05-ggplot2-scatter-plot.html">05-ggplot2 绘图——散点图</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">05-ggplot2 绘图——散点图</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> 代码</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">作者</div>
    <div class="quarto-title-meta-contents">
             <p>Simonzhou </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">发布于</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2025年7月25日</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">修改于</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">2025年7月25日</p>
    </div>
  </div>
    
  </div>
  


</header><section id="散点图" class="level1 page-columns page-full" data-number="1"><h1 data-number="1">
<span class="header-section-number">1</span> 散点图</h1>
<p>散点图常用来刻画两个连续变量之间的关系。</p>
<p>绘制散点图时，数据集中的每一个观测值都由散点图中的一个点来表示。通常，人们还会向散点图中添加一条直线，以用来表示基于某些统计模型的预测值。当散点图中的数据趋势难以用肉眼识别时，这些直线对我们理解数据的特征很有帮助。</p>
<p>当数据集很大时，散点图上的数据点会相互重叠，此时，很难在图上清楚地显示出所有的数据点。为了解决重叠的问题，我们可以先对数据进行汇总，再绘制散点图。</p>
<section id="绘制基本散点图" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="绘制基本散点图">
<span class="header-section-number">1.1</span> 绘制基本散点图</h2>
<p>使用 <code>geom_point()</code> 函数，分别映射一个变量到 x 和一个变量到 y。</p>
<p>这里使用 <code>heightweight</code> 数据集，这是一个多列数据集，接下来的例子我们只用到其中两列。</p>
<div class="cell" data-fig="true">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># load package</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># 列出我们绘制散点图要用到的两列的标题</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>heightweight <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="fu">select</span>(ageYear, heightIn)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    ageYear heightIn
1     11.92     56.3
2     12.92     62.3
3     12.75     63.3
4     13.42     59.0
5     15.92     62.5
6     14.25     62.5
7     15.42     59.0
8     11.83     56.5
9     13.33     62.0
10    11.67     53.8
11    11.58     61.5
12    14.83     61.5
13    13.08     64.5
14    12.42     58.3
15    11.92     51.3
16    12.08     58.8
17    15.92     65.3
18    12.50     59.5
19    12.25     61.3
20    15.00     63.3
21    11.75     61.8
22    11.67     53.5
23    13.67     58.0
24    14.67     61.3
25    15.42     63.3
26    13.83     61.5
27    14.58     60.8
28    15.00     59.0
29    17.50     65.5
30    12.17     56.3
31    14.17     64.3
32    13.50     58.0
33    12.42     64.3
34    11.58     57.5
35    15.50     57.8
36    16.42     61.5
37    14.08     62.3
38    14.75     61.8
39    15.42     65.3
40    15.17     58.3
41    14.42     62.8
42    13.83     59.3
43    14.00     61.5
44    14.08     62.0
45    12.50     61.3
46    15.33     62.3
47    11.58     52.8
48    12.25     59.8
49    12.00     59.5
50    14.75     61.3
51    14.83     63.5
52    16.42     64.8
53    12.17     60.0
54    12.08     59.0
55    12.25     55.8
56    12.08     57.8
57    12.92     61.3
58    13.92     62.3
59    15.25     64.3
60    11.92     55.5
61    15.25     64.5
62    15.42     60.0
63    12.33     56.3
64    12.25     58.3
65    12.83     60.0
66    13.00     54.5
67    12.00     55.8
68    12.83     62.8
69    12.67     60.5
70    15.92     63.3
71    15.83     66.8
72    11.67     60.0
73    12.33     60.5
74    15.75     64.3
75    11.92     58.3
76    14.83     66.5
77    13.67     65.3
78    13.08     60.5
79    12.25     59.5
80    12.33     59.0
81    14.75     61.3
82    14.25     61.5
83    14.33     64.8
84    15.83     56.8
85    15.25     66.5
86    11.92     61.5
87    14.92     63.0
88    15.50     57.0
89    15.17     65.5
90    15.17     62.0
91    11.83     56.0
92    13.75     61.3
93    13.75     55.5
94    12.83     61.0
95    12.50     54.5
96    12.92     66.0
97    13.58     56.5
98    11.75     56.0
99    12.25     51.5
100   17.50     62.0
101   14.25     63.0
102   13.92     61.0
103   15.17     64.0
104   12.00     61.0
105   16.08     59.8
106   11.75     61.3
107   13.67     63.3
108   15.50     63.5
109   14.08     61.5
110   14.58     60.3
111   15.00     61.3
112   13.75     64.8
113   13.08     60.5
114   12.00     57.3
115   12.50     59.5
116   12.50     60.8
117   11.58     60.5
118   15.75     67.0
119   15.25     64.8
120   12.25     50.5
121   12.17     57.5
122   13.33     60.5
123   13.00     61.8
124   14.42     61.3
125   12.58     66.3
126   11.75     53.3
127   12.50     59.0
128   13.67     57.8
129   12.75     60.0
130   17.17     68.3
132   14.67     63.8
133   14.67     65.0
134   11.67     59.5
135   15.42     66.0
136   15.00     61.8
137   12.17     57.3
138   15.25     66.0
139   11.67     56.5
140   12.58     58.3
141   12.58     61.0
142   12.00     62.8
143   13.33     59.3
144   14.83     67.3
145   16.08     66.3
146   13.50     64.5
147   13.67     60.5
148   15.50     66.0
149   11.92     57.5
150   14.58     64.0
151   14.58     68.0
152   14.58     63.5
153   14.42     69.0
154   14.17     63.8
155   14.50     66.0
156   13.67     63.5
157   12.00     59.5
158   13.00     66.3
159   12.42     57.0
160   12.00     60.0
161   12.25     57.0
162   15.67     67.3
163   14.08     62.0
164   14.33     65.0
165   12.50     59.5
166   16.08     67.8
167   13.08     58.0
168   14.00     60.0
169   11.67     58.5
170   13.00     58.3
171   13.00     61.5
172   13.17     65.0
173   15.33     66.5
174   13.00     68.5
175   12.00     57.0
176   14.67     61.5
177   14.00     66.5
178   12.42     52.5
179   11.83     55.0
180   15.67     71.0
181   16.92     66.5
182   11.83     58.8
183   15.75     66.3
184   15.67     65.8
185   16.67     71.0
186   12.67     59.5
187   14.50     69.8
188   13.83     62.5
189   12.08     56.5
190   11.92     57.5
191   13.58     65.3
192   13.83     67.3
193   15.17     67.0
194   14.42     66.0
195   12.92     61.8
196   13.50     60.0
197   14.75     63.0
198   14.75     60.5
199   14.58     65.5
200   13.83     62.0
201   12.50     59.0
202   12.50     61.8
203   15.67     63.3
204   13.58     66.0
205   14.25     61.8
206   13.50     63.0
207   11.75     57.5
208   14.50     63.0
209   11.83     56.0
210   12.33     60.5
211   11.67     56.8
212   13.33     64.0
213   12.00     60.0
214   17.17     69.5
215   13.25     63.3
216   12.42     56.3
217   16.08     72.0
218   16.17     65.3
219   12.67     60.8
220   12.17     55.0
221   11.58     55.0
222   15.50     66.5
223   13.42     56.8
224   12.75     64.8
225   16.33     64.5
226   13.67     58.0
227   13.25     62.8
228   14.83     63.8
229   12.75     57.8
230   12.92     57.3
231   14.83     63.5
232   11.83     55.0
233   13.67     66.5
234   15.75     65.0
235   13.67     61.5
236   13.92     62.0
237   12.58     59.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">#&gt;     ageYear heightIn</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; 1     11.92     56.3</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; 2     12.92     62.3</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; 3     12.75     63.3</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt;  ...&lt;230 more rows&gt;...</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; 235   13.67     61.5</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; 236   13.92     62.0</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; 237   12.58     59.3</span></span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb3-11"><a href="#cb3-11"></a>  <span class="fu">geom_point</span>()</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>基本散点图</figcaption></figure>
</div>
</div>
</div>
<p>通过设定形状（shape）参数可以在散点图中绘制点以外的形状。例如，我们常用空心圈 <code>shape=21</code>（图 <span class="citation" data-cites="fig5-3">(<a href="#ref-fig5-3" role="doc-biblioref"><strong>fig5-3?</strong></a>)</span> ）代替默认的实心圆 <code>shape=19</code>（图 <span class="citation" data-cites="fig5-1">(<a href="#ref-fig5-1" role="doc-biblioref"><strong>fig5-1?</strong></a>)</span> ）​。</p>
<div class="cell" data-fig="true">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># load package</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># 列出我们绘制散点图要用到的两列的标题</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>heightweight <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8"></a>  <span class="fu">select</span>(ageYear, heightIn)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    ageYear heightIn
1     11.92     56.3
2     12.92     62.3
3     12.75     63.3
4     13.42     59.0
5     15.92     62.5
6     14.25     62.5
7     15.42     59.0
8     11.83     56.5
9     13.33     62.0
10    11.67     53.8
11    11.58     61.5
12    14.83     61.5
13    13.08     64.5
14    12.42     58.3
15    11.92     51.3
16    12.08     58.8
17    15.92     65.3
18    12.50     59.5
19    12.25     61.3
20    15.00     63.3
21    11.75     61.8
22    11.67     53.5
23    13.67     58.0
24    14.67     61.3
25    15.42     63.3
26    13.83     61.5
27    14.58     60.8
28    15.00     59.0
29    17.50     65.5
30    12.17     56.3
31    14.17     64.3
32    13.50     58.0
33    12.42     64.3
34    11.58     57.5
35    15.50     57.8
36    16.42     61.5
37    14.08     62.3
38    14.75     61.8
39    15.42     65.3
40    15.17     58.3
41    14.42     62.8
42    13.83     59.3
43    14.00     61.5
44    14.08     62.0
45    12.50     61.3
46    15.33     62.3
47    11.58     52.8
48    12.25     59.8
49    12.00     59.5
50    14.75     61.3
51    14.83     63.5
52    16.42     64.8
53    12.17     60.0
54    12.08     59.0
55    12.25     55.8
56    12.08     57.8
57    12.92     61.3
58    13.92     62.3
59    15.25     64.3
60    11.92     55.5
61    15.25     64.5
62    15.42     60.0
63    12.33     56.3
64    12.25     58.3
65    12.83     60.0
66    13.00     54.5
67    12.00     55.8
68    12.83     62.8
69    12.67     60.5
70    15.92     63.3
71    15.83     66.8
72    11.67     60.0
73    12.33     60.5
74    15.75     64.3
75    11.92     58.3
76    14.83     66.5
77    13.67     65.3
78    13.08     60.5
79    12.25     59.5
80    12.33     59.0
81    14.75     61.3
82    14.25     61.5
83    14.33     64.8
84    15.83     56.8
85    15.25     66.5
86    11.92     61.5
87    14.92     63.0
88    15.50     57.0
89    15.17     65.5
90    15.17     62.0
91    11.83     56.0
92    13.75     61.3
93    13.75     55.5
94    12.83     61.0
95    12.50     54.5
96    12.92     66.0
97    13.58     56.5
98    11.75     56.0
99    12.25     51.5
100   17.50     62.0
101   14.25     63.0
102   13.92     61.0
103   15.17     64.0
104   12.00     61.0
105   16.08     59.8
106   11.75     61.3
107   13.67     63.3
108   15.50     63.5
109   14.08     61.5
110   14.58     60.3
111   15.00     61.3
112   13.75     64.8
113   13.08     60.5
114   12.00     57.3
115   12.50     59.5
116   12.50     60.8
117   11.58     60.5
118   15.75     67.0
119   15.25     64.8
120   12.25     50.5
121   12.17     57.5
122   13.33     60.5
123   13.00     61.8
124   14.42     61.3
125   12.58     66.3
126   11.75     53.3
127   12.50     59.0
128   13.67     57.8
129   12.75     60.0
130   17.17     68.3
132   14.67     63.8
133   14.67     65.0
134   11.67     59.5
135   15.42     66.0
136   15.00     61.8
137   12.17     57.3
138   15.25     66.0
139   11.67     56.5
140   12.58     58.3
141   12.58     61.0
142   12.00     62.8
143   13.33     59.3
144   14.83     67.3
145   16.08     66.3
146   13.50     64.5
147   13.67     60.5
148   15.50     66.0
149   11.92     57.5
150   14.58     64.0
151   14.58     68.0
152   14.58     63.5
153   14.42     69.0
154   14.17     63.8
155   14.50     66.0
156   13.67     63.5
157   12.00     59.5
158   13.00     66.3
159   12.42     57.0
160   12.00     60.0
161   12.25     57.0
162   15.67     67.3
163   14.08     62.0
164   14.33     65.0
165   12.50     59.5
166   16.08     67.8
167   13.08     58.0
168   14.00     60.0
169   11.67     58.5
170   13.00     58.3
171   13.00     61.5
172   13.17     65.0
173   15.33     66.5
174   13.00     68.5
175   12.00     57.0
176   14.67     61.5
177   14.00     66.5
178   12.42     52.5
179   11.83     55.0
180   15.67     71.0
181   16.92     66.5
182   11.83     58.8
183   15.75     66.3
184   15.67     65.8
185   16.67     71.0
186   12.67     59.5
187   14.50     69.8
188   13.83     62.5
189   12.08     56.5
190   11.92     57.5
191   13.58     65.3
192   13.83     67.3
193   15.17     67.0
194   14.42     66.0
195   12.92     61.8
196   13.50     60.0
197   14.75     63.0
198   14.75     60.5
199   14.58     65.5
200   13.83     62.0
201   12.50     59.0
202   12.50     61.8
203   15.67     63.3
204   13.58     66.0
205   14.25     61.8
206   13.50     63.0
207   11.75     57.5
208   14.50     63.0
209   11.83     56.0
210   12.33     60.5
211   11.67     56.8
212   13.33     64.0
213   12.00     60.0
214   17.17     69.5
215   13.25     63.3
216   12.42     56.3
217   16.08     72.0
218   16.17     65.3
219   12.67     60.8
220   12.17     55.0
221   11.58     55.0
222   15.50     66.5
223   13.42     56.8
224   12.75     64.8
225   16.33     64.5
226   13.67     58.0
227   13.25     62.8
228   14.83     63.8
229   12.75     57.8
230   12.92     57.3
231   14.83     63.5
232   11.83     55.0
233   13.67     66.5
234   15.75     65.0
235   13.67     61.5
236   13.92     62.0
237   12.58     59.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>基本散点图-修改形状</figcaption></figure>
</div>
</div>
</div>
<p>修改点的大小（在默认实心圆点的情况下），默认点的大小为：<code>size=2</code>。</p>
<div class="cell" data-fig="true">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># load package</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># 列出我们绘制散点图要用到的两列的标题</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>heightweight <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">select</span>(ageYear, heightIn)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    ageYear heightIn
1     11.92     56.3
2     12.92     62.3
3     12.75     63.3
4     13.42     59.0
5     15.92     62.5
6     14.25     62.5
7     15.42     59.0
8     11.83     56.5
9     13.33     62.0
10    11.67     53.8
11    11.58     61.5
12    14.83     61.5
13    13.08     64.5
14    12.42     58.3
15    11.92     51.3
16    12.08     58.8
17    15.92     65.3
18    12.50     59.5
19    12.25     61.3
20    15.00     63.3
21    11.75     61.8
22    11.67     53.5
23    13.67     58.0
24    14.67     61.3
25    15.42     63.3
26    13.83     61.5
27    14.58     60.8
28    15.00     59.0
29    17.50     65.5
30    12.17     56.3
31    14.17     64.3
32    13.50     58.0
33    12.42     64.3
34    11.58     57.5
35    15.50     57.8
36    16.42     61.5
37    14.08     62.3
38    14.75     61.8
39    15.42     65.3
40    15.17     58.3
41    14.42     62.8
42    13.83     59.3
43    14.00     61.5
44    14.08     62.0
45    12.50     61.3
46    15.33     62.3
47    11.58     52.8
48    12.25     59.8
49    12.00     59.5
50    14.75     61.3
51    14.83     63.5
52    16.42     64.8
53    12.17     60.0
54    12.08     59.0
55    12.25     55.8
56    12.08     57.8
57    12.92     61.3
58    13.92     62.3
59    15.25     64.3
60    11.92     55.5
61    15.25     64.5
62    15.42     60.0
63    12.33     56.3
64    12.25     58.3
65    12.83     60.0
66    13.00     54.5
67    12.00     55.8
68    12.83     62.8
69    12.67     60.5
70    15.92     63.3
71    15.83     66.8
72    11.67     60.0
73    12.33     60.5
74    15.75     64.3
75    11.92     58.3
76    14.83     66.5
77    13.67     65.3
78    13.08     60.5
79    12.25     59.5
80    12.33     59.0
81    14.75     61.3
82    14.25     61.5
83    14.33     64.8
84    15.83     56.8
85    15.25     66.5
86    11.92     61.5
87    14.92     63.0
88    15.50     57.0
89    15.17     65.5
90    15.17     62.0
91    11.83     56.0
92    13.75     61.3
93    13.75     55.5
94    12.83     61.0
95    12.50     54.5
96    12.92     66.0
97    13.58     56.5
98    11.75     56.0
99    12.25     51.5
100   17.50     62.0
101   14.25     63.0
102   13.92     61.0
103   15.17     64.0
104   12.00     61.0
105   16.08     59.8
106   11.75     61.3
107   13.67     63.3
108   15.50     63.5
109   14.08     61.5
110   14.58     60.3
111   15.00     61.3
112   13.75     64.8
113   13.08     60.5
114   12.00     57.3
115   12.50     59.5
116   12.50     60.8
117   11.58     60.5
118   15.75     67.0
119   15.25     64.8
120   12.25     50.5
121   12.17     57.5
122   13.33     60.5
123   13.00     61.8
124   14.42     61.3
125   12.58     66.3
126   11.75     53.3
127   12.50     59.0
128   13.67     57.8
129   12.75     60.0
130   17.17     68.3
132   14.67     63.8
133   14.67     65.0
134   11.67     59.5
135   15.42     66.0
136   15.00     61.8
137   12.17     57.3
138   15.25     66.0
139   11.67     56.5
140   12.58     58.3
141   12.58     61.0
142   12.00     62.8
143   13.33     59.3
144   14.83     67.3
145   16.08     66.3
146   13.50     64.5
147   13.67     60.5
148   15.50     66.0
149   11.92     57.5
150   14.58     64.0
151   14.58     68.0
152   14.58     63.5
153   14.42     69.0
154   14.17     63.8
155   14.50     66.0
156   13.67     63.5
157   12.00     59.5
158   13.00     66.3
159   12.42     57.0
160   12.00     60.0
161   12.25     57.0
162   15.67     67.3
163   14.08     62.0
164   14.33     65.0
165   12.50     59.5
166   16.08     67.8
167   13.08     58.0
168   14.00     60.0
169   11.67     58.5
170   13.00     58.3
171   13.00     61.5
172   13.17     65.0
173   15.33     66.5
174   13.00     68.5
175   12.00     57.0
176   14.67     61.5
177   14.00     66.5
178   12.42     52.5
179   11.83     55.0
180   15.67     71.0
181   16.92     66.5
182   11.83     58.8
183   15.75     66.3
184   15.67     65.8
185   16.67     71.0
186   12.67     59.5
187   14.50     69.8
188   13.83     62.5
189   12.08     56.5
190   11.92     57.5
191   13.58     65.3
192   13.83     67.3
193   15.17     67.0
194   14.42     66.0
195   12.92     61.8
196   13.50     60.0
197   14.75     63.0
198   14.75     60.5
199   14.58     65.5
200   13.83     62.0
201   12.50     59.0
202   12.50     61.8
203   15.67     63.3
204   13.58     66.0
205   14.25     61.8
206   13.50     63.0
207   11.75     57.5
208   14.50     63.0
209   11.83     56.0
210   12.33     60.5
211   11.67     56.8
212   13.33     64.0
213   12.00     60.0
214   17.17     69.5
215   13.25     63.3
216   12.42     56.3
217   16.08     72.0
218   16.17     65.3
219   12.67     60.8
220   12.17     55.0
221   11.58     55.0
222   15.50     66.5
223   13.42     56.8
224   12.75     64.8
225   16.33     64.5
226   13.67     58.0
227   13.25     62.8
228   14.83     63.8
229   12.75     57.8
230   12.92     57.3
231   14.83     63.5
232   11.83     55.0
233   13.67     66.5
234   15.75     65.0
235   13.67     61.5
236   13.92     62.0
237   12.58     59.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>基本散点图-修改散点大小</figcaption></figure>
</div>
</div>
</div>
</section><section id="使用点形或颜色属性对数据点进行分组" class="level2 page-columns page-full" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="使用点形或颜色属性对数据点进行分组">
<span class="header-section-number">1.2</span> 使用点形或颜色属性对数据点进行分组</h2>
<p>将分组变量映射到点形（<code>shape</code>）或颜色（<code>colour</code>）属性。</p>
<p>接下来的例子中，我们将用到 <code>heightweight</code> 数据集中的3列。</p>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># load package</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb10-5"><a href="#cb10-5"></a></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co"># 列出要用到的3列的标题</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>heightweight <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">select</span>(sex, ageYear, heightIn)</span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;     sex ageYear heightIn</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; 1     f   11.92     56.3</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; 2     f   12.92     62.3</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; 3     f   12.75     63.3</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt;  ...&lt;230 more rows&gt;...</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; 235   m   13.67     61.5</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; 236   m   13.92     62.0</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; 237   m   12.58     59.3</span></span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn,<span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb10-19"><a href="#cb10-19"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb10-20"><a href="#cb10-20"></a></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn,<span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb10-22"><a href="#cb10-22"></a>  <span class="fu">geom_point</span>()</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell column-page-right quarto-layout-panel" data-fig="true" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<pre><code>    sex ageYear heightIn
1     f   11.92     56.3
2     f   12.92     62.3
3     f   12.75     63.3
4     f   13.42     59.0
5     f   15.92     62.5
6     f   14.25     62.5
7     f   15.42     59.0
8     f   11.83     56.5
9     f   13.33     62.0
10    f   11.67     53.8
11    f   11.58     61.5
12    f   14.83     61.5
13    f   13.08     64.5
14    f   12.42     58.3
15    f   11.92     51.3
16    f   12.08     58.8
17    f   15.92     65.3
18    f   12.50     59.5
19    f   12.25     61.3
20    f   15.00     63.3
21    f   11.75     61.8
22    f   11.67     53.5
23    f   13.67     58.0
24    f   14.67     61.3
25    f   15.42     63.3
26    f   13.83     61.5
27    f   14.58     60.8
28    f   15.00     59.0
29    f   17.50     65.5
30    f   12.17     56.3
31    f   14.17     64.3
32    f   13.50     58.0
33    f   12.42     64.3
34    f   11.58     57.5
35    f   15.50     57.8
36    f   16.42     61.5
37    f   14.08     62.3
38    f   14.75     61.8
39    f   15.42     65.3
40    f   15.17     58.3
41    f   14.42     62.8
42    f   13.83     59.3
43    f   14.00     61.5
44    f   14.08     62.0
45    f   12.50     61.3
46    f   15.33     62.3
47    f   11.58     52.8
48    f   12.25     59.8
49    f   12.00     59.5
50    f   14.75     61.3
51    f   14.83     63.5
52    f   16.42     64.8
53    f   12.17     60.0
54    f   12.08     59.0
55    f   12.25     55.8
56    f   12.08     57.8
57    f   12.92     61.3
58    f   13.92     62.3
59    f   15.25     64.3
60    f   11.92     55.5
61    f   15.25     64.5
62    f   15.42     60.0
63    f   12.33     56.3
64    f   12.25     58.3
65    f   12.83     60.0
66    f   13.00     54.5
67    f   12.00     55.8
68    f   12.83     62.8
69    f   12.67     60.5
70    f   15.92     63.3
71    f   15.83     66.8
72    f   11.67     60.0
73    f   12.33     60.5
74    f   15.75     64.3
75    f   11.92     58.3
76    f   14.83     66.5
77    f   13.67     65.3
78    f   13.08     60.5
79    f   12.25     59.5
80    f   12.33     59.0
81    f   14.75     61.3
82    f   14.25     61.5
83    f   14.33     64.8
84    f   15.83     56.8
85    f   15.25     66.5
86    f   11.92     61.5
87    f   14.92     63.0
88    f   15.50     57.0
89    f   15.17     65.5
90    f   15.17     62.0
91    f   11.83     56.0
92    f   13.75     61.3
93    f   13.75     55.5
94    f   12.83     61.0
95    f   12.50     54.5
96    f   12.92     66.0
97    f   13.58     56.5
98    f   11.75     56.0
99    f   12.25     51.5
100   f   17.50     62.0
101   f   14.25     63.0
102   f   13.92     61.0
103   f   15.17     64.0
104   f   12.00     61.0
105   f   16.08     59.8
106   f   11.75     61.3
107   f   13.67     63.3
108   f   15.50     63.5
109   f   14.08     61.5
110   f   14.58     60.3
111   f   15.00     61.3
112   m   13.75     64.8
113   m   13.08     60.5
114   m   12.00     57.3
115   m   12.50     59.5
116   m   12.50     60.8
117   m   11.58     60.5
118   m   15.75     67.0
119   m   15.25     64.8
120   m   12.25     50.5
121   m   12.17     57.5
122   m   13.33     60.5
123   m   13.00     61.8
124   m   14.42     61.3
125   m   12.58     66.3
126   m   11.75     53.3
127   m   12.50     59.0
128   m   13.67     57.8
129   m   12.75     60.0
130   m   17.17     68.3
132   m   14.67     63.8
133   m   14.67     65.0
134   m   11.67     59.5
135   m   15.42     66.0
136   m   15.00     61.8
137   m   12.17     57.3
138   m   15.25     66.0
139   m   11.67     56.5
140   m   12.58     58.3
141   m   12.58     61.0
142   m   12.00     62.8
143   m   13.33     59.3
144   m   14.83     67.3
145   m   16.08     66.3
146   m   13.50     64.5
147   m   13.67     60.5
148   m   15.50     66.0
149   m   11.92     57.5
150   m   14.58     64.0
151   m   14.58     68.0
152   m   14.58     63.5
153   m   14.42     69.0
154   m   14.17     63.8
155   m   14.50     66.0
156   m   13.67     63.5
157   m   12.00     59.5
158   m   13.00     66.3
159   m   12.42     57.0
160   m   12.00     60.0
161   m   12.25     57.0
162   m   15.67     67.3
163   m   14.08     62.0
164   m   14.33     65.0
165   m   12.50     59.5
166   m   16.08     67.8
167   m   13.08     58.0
168   m   14.00     60.0
169   m   11.67     58.5
170   m   13.00     58.3
171   m   13.00     61.5
172   m   13.17     65.0
173   m   15.33     66.5
174   m   13.00     68.5
175   m   12.00     57.0
176   m   14.67     61.5
177   m   14.00     66.5
178   m   12.42     52.5
179   m   11.83     55.0
180   m   15.67     71.0
181   m   16.92     66.5
182   m   11.83     58.8
183   m   15.75     66.3
184   m   15.67     65.8
185   m   16.67     71.0
186   m   12.67     59.5
187   m   14.50     69.8
188   m   13.83     62.5
189   m   12.08     56.5
190   m   11.92     57.5
191   m   13.58     65.3
192   m   13.83     67.3
193   m   15.17     67.0
194   m   14.42     66.0
195   m   12.92     61.8
196   m   13.50     60.0
197   m   14.75     63.0
198   m   14.75     60.5
199   m   14.58     65.5
200   m   13.83     62.0
201   m   12.50     59.0
202   m   12.50     61.8
203   m   15.67     63.3
204   m   13.58     66.0
205   m   14.25     61.8
206   m   13.50     63.0
207   m   11.75     57.5
208   m   14.50     63.0
209   m   11.83     56.0
210   m   12.33     60.5
211   m   11.67     56.8
212   m   13.33     64.0
213   m   12.00     60.0
214   m   17.17     69.5
215   m   13.25     63.3
216   m   12.42     56.3
217   m   16.08     72.0
218   m   16.17     65.3
219   m   12.67     60.8
220   m   12.17     55.0
221   m   11.58     55.0
222   m   15.50     66.5
223   m   13.42     56.8
224   m   12.75     64.8
225   m   16.33     64.5
226   m   13.67     58.0
227   m   13.25     62.8
228   m   14.83     63.8
229   m   12.75     57.8
230   m   12.92     57.3
231   m   14.83     63.5
232   m   11.83     55.0
233   m   13.67     66.5
234   m   15.75     65.0
235   m   13.67     61.5
236   m   13.92     62.0
237   m   12.58     59.3</code></pre>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>按颜色分组</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-4-2.png" class="img-fluid figure-img" width="672"></p>
<figcaption>按形状分组</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>基本散点图-按形/色分组</p>
</div>
</div>
</div>
<p>选用的分组变量必须是分类变量，换言之，它必须是因子型或者字符型的向量。如果分组变量是数值型向量，则需要将它转化为因子型变量之后，才能以其作为分组变量。</p>
<p>可以将一个变量同时映射到 <code>shape</code> 和 <code>colour</code> 属性。当有多个分组变量时，可以将它们分别映射到不同的图形属性。下面，我们把变量 <code>sex</code> 同时映射到 <code>shape</code> 和 <code>colour</code> 属性，见图 <span class="citation" data-cites="fig5-5">(<a href="#ref-fig5-5" role="doc-biblioref"><strong>fig5-5?</strong></a>)</span> 。</p>
<div class="cell" data-fig="true">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn,<span class="at">color =</span> sex,<span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-5-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>基本散点图-按形和色分组</figcaption></figure>
</div>
</div>
</div>
<p>有时需要使用不同于默认设置的点形和颜色。通过调用<code>scale_shape_manual()</code> 函数可以使用其他点形；</p>
<p>调用 <code>scale_colour_brewer()</code> 函数或者 <code>scale_colour_manual()</code> 函数可以使用其他调色板，见图 <span class="citation" data-cites="fig5-6">(<a href="#ref-fig5-6" role="doc-biblioref"><strong>fig5-6?</strong></a>)</span> 。</p>
<div class="cell" data-fig="true">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn, <span class="at">shape =</span> sex, <span class="at">colour =</span> sex)) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-6-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>基本散点图-修改调色板</figcaption></figure>
</div>
</div>
</div>
</section><section id="使用不同于默认设置的点形" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="使用不同于默认设置的点形">
<span class="header-section-number">1.3</span> 使用不同于默认设置的点形</h2>
<p>通过指定 <code>geom_point()</code> 函数中的点形（<code>shape</code>）参数，可以同时设定散点图中所有数据点的点形，如图 <span class="citation" data-cites="fig5-7">(<a href="#ref-fig5-7" role="doc-biblioref"><strong>fig5-7?</strong></a>)</span> 所示。</p>
<div class="cell" data-fig="true">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">3</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-7-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>指定散点形状</figcaption></figure>
</div>
</div>
</div>
<p>R系统绘图可以调用的图形较多，一些点形只有边框线（1～14）​；一些只有实心填充区域（15～20）​；还有一些则由可分离的边框线和具有填充色的实心区域共同组成（21～25）​，也可以用字符作点形。</p>
<p>如果已将分组变量映射到 <code>shape</code>，则可以调用 <code>scale_shape_manual()</code> 函数来手动修改该分组变量不同水平的点形</p>
<p>下图将使用略大且自定义点形的数据点：</p>
<div class="cell" data-fig="true">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn, <span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure"><p><img src="05-ggplot2-scatter-plot_files/figure-html/fig5-8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption>自定义散点形状</figcaption></figure>
</div>
</div>
</div>
<ul>
<li><p>点形1～20的点的颜色，包括实心区域的颜色都可由 <code>colour</code> 参数来控制。</p></li>
<li><p>对于点形21～25而言，边框线和实心区域的颜色则分别由 <code>colour</code> 和 <code>fill</code> 参数来控制。</p></li>
</ul>
<p>我们可以将两个不同的变量分别由点形和填充色（空心或有填充）属性来表示。</p>
<p>为了实现这一功能，首先需要选择一个同时具有 <code>colour</code> 和 <code>fill</code> 属性的点形，在 <code>scale_shape_manual</code> 中设定。之后需要在<code>scale_fill_manual()</code> 中选择一个包括 NA 和其他颜色的调色板（NA会生成一个空心的形状）​。</p>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已复制");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已复制");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("www\.lazyzhou\.cn");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="pumc-zhou/comments" data-repo-id="R_kgDON9RmWA" data-category="General" data-category-id="DIC_kwDON9RmWM4CnLUH" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../Guide/R/04-ggplot2-folded-line.html" class="pagination-link" aria-label="04-ggplot2 绘图——折线图">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">04-ggplot2 绘图——折线图</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../Guide/Python/2025-02-20-Medical-expenses.html" class="pagination-link" aria-label="用Python和Stata处理一份卫生费用数据">
        <span class="nav-page-text">用Python和Stata处理一份卫生费用数据</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">源代码</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb16" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">---</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="an">title:</span><span class="co"> "05-ggplot2 绘图——散点图"</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="an">author:</span><span class="co"> "Simonzhou"</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="an">date:</span><span class="co"> "2025-07-25"</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="an">date-modified:</span><span class="co"> today</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">    html:</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">        code-fold: true</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">        code-line-numbers: true</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">        code-highlight: true</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">        fig_caption: true</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">        number-sections: true</span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">        toc: true</span></span>
<span id="cb16-14"><a href="#cb16-14"></a><span class="co">        toc-depth: 3</span></span>
<span id="cb16-15"><a href="#cb16-15"></a><span class="co">---</span></span>
<span id="cb16-16"><a href="#cb16-16"></a></span>
<span id="cb16-17"><a href="#cb16-17"></a><span class="fu"># 散点图</span></span>
<span id="cb16-18"><a href="#cb16-18"></a></span>
<span id="cb16-19"><a href="#cb16-19"></a>散点图常用来刻画两个连续变量之间的关系。</span>
<span id="cb16-20"><a href="#cb16-20"></a></span>
<span id="cb16-21"><a href="#cb16-21"></a>绘制散点图时，数据集中的每一个观测值都由散点图中的一个点来表示。通常，人们还会向散点图中添加一条直线，以用来表示基于某些统计模型的预测值。当散点图中的数据趋势难以用肉眼识别时，这些直线对我们理解数据的特征很有帮助。</span>
<span id="cb16-22"><a href="#cb16-22"></a></span>
<span id="cb16-23"><a href="#cb16-23"></a>当数据集很大时，散点图上的数据点会相互重叠，此时，很难在图上清楚地显示出所有的数据点。为了解决重叠的问题，我们可以先对数据进行汇总，再绘制散点图。</span>
<span id="cb16-24"><a href="#cb16-24"></a></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="fu">## 绘制基本散点图</span></span>
<span id="cb16-26"><a href="#cb16-26"></a></span>
<span id="cb16-27"><a href="#cb16-27"></a>使用 <span class="in">`geom_point()`</span> 函数，分别映射一个变量到 x 和一个变量到 y。</span>
<span id="cb16-28"><a href="#cb16-28"></a></span>
<span id="cb16-29"><a href="#cb16-29"></a>这里使用 <span class="in">`heightweight`</span> 数据集，这是一个多列数据集，接下来的例子我们只用到其中两列。</span>
<span id="cb16-30"><a href="#cb16-30"></a></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="in">```{r}</span></span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="co">#| eval: true</span></span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="co">#| echo: true</span></span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-37"><a href="#cb16-37"></a><span class="co">#| label: fig5-1</span></span>
<span id="cb16-38"><a href="#cb16-38"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-39"><a href="#cb16-39"></a><span class="co">#| fig.cap: "基本散点图"</span></span>
<span id="cb16-40"><a href="#cb16-40"></a></span>
<span id="cb16-41"><a href="#cb16-41"></a><span class="co"># load package</span></span>
<span id="cb16-42"><a href="#cb16-42"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-43"><a href="#cb16-43"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb16-44"><a href="#cb16-44"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb16-45"><a href="#cb16-45"></a></span>
<span id="cb16-46"><a href="#cb16-46"></a><span class="co"># 列出我们绘制散点图要用到的两列的标题</span></span>
<span id="cb16-47"><a href="#cb16-47"></a>heightweight <span class="sc">%&gt;%</span> </span>
<span id="cb16-48"><a href="#cb16-48"></a>  <span class="fu">select</span>(ageYear, heightIn)</span>
<span id="cb16-49"><a href="#cb16-49"></a><span class="co">#&gt;     ageYear heightIn</span></span>
<span id="cb16-50"><a href="#cb16-50"></a><span class="co">#&gt; 1     11.92     56.3</span></span>
<span id="cb16-51"><a href="#cb16-51"></a><span class="co">#&gt; 2     12.92     62.3</span></span>
<span id="cb16-52"><a href="#cb16-52"></a><span class="co">#&gt; 3     12.75     63.3</span></span>
<span id="cb16-53"><a href="#cb16-53"></a><span class="co">#&gt;  ...&lt;230 more rows&gt;...</span></span>
<span id="cb16-54"><a href="#cb16-54"></a><span class="co">#&gt; 235   13.67     61.5</span></span>
<span id="cb16-55"><a href="#cb16-55"></a><span class="co">#&gt; 236   13.92     62.0</span></span>
<span id="cb16-56"><a href="#cb16-56"></a><span class="co">#&gt; 237   12.58     59.3</span></span>
<span id="cb16-57"><a href="#cb16-57"></a></span>
<span id="cb16-58"><a href="#cb16-58"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb16-59"><a href="#cb16-59"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb16-60"><a href="#cb16-60"></a><span class="in">```</span></span>
<span id="cb16-61"><a href="#cb16-61"></a></span>
<span id="cb16-62"><a href="#cb16-62"></a>通过设定形状（shape）参数可以在散点图中绘制点以外的形状。例如，我们常用空心圈 <span class="in">`shape=21`</span>（图 @fig5-3 ）代替默认的实心圆 <span class="in">`shape=19`</span>（图 @fig5-1 ）​。</span>
<span id="cb16-63"><a href="#cb16-63"></a></span>
<span id="cb16-66"><a href="#cb16-66"></a><span class="in">```{r}</span></span>
<span id="cb16-67"><a href="#cb16-67"></a><span class="co">#| eval: true</span></span>
<span id="cb16-68"><a href="#cb16-68"></a><span class="co">#| echo: true</span></span>
<span id="cb16-69"><a href="#cb16-69"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-70"><a href="#cb16-70"></a><span class="co">#| label: fig5-2</span></span>
<span id="cb16-71"><a href="#cb16-71"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-72"><a href="#cb16-72"></a><span class="co">#| fig.cap: "基本散点图-修改形状"</span></span>
<span id="cb16-73"><a href="#cb16-73"></a></span>
<span id="cb16-74"><a href="#cb16-74"></a><span class="co"># load package</span></span>
<span id="cb16-75"><a href="#cb16-75"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-76"><a href="#cb16-76"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb16-77"><a href="#cb16-77"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb16-78"><a href="#cb16-78"></a></span>
<span id="cb16-79"><a href="#cb16-79"></a><span class="co"># 列出我们绘制散点图要用到的两列的标题</span></span>
<span id="cb16-80"><a href="#cb16-80"></a>heightweight <span class="sc">%&gt;%</span> </span>
<span id="cb16-81"><a href="#cb16-81"></a>  <span class="fu">select</span>(ageYear, heightIn)</span>
<span id="cb16-82"><a href="#cb16-82"></a></span>
<span id="cb16-83"><a href="#cb16-83"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb16-84"><a href="#cb16-84"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>)</span>
<span id="cb16-85"><a href="#cb16-85"></a><span class="in">```</span></span>
<span id="cb16-86"><a href="#cb16-86"></a></span>
<span id="cb16-87"><a href="#cb16-87"></a>修改点的大小（在默认实心圆点的情况下），默认点的大小为：<span class="in">`size=2`</span>。</span>
<span id="cb16-88"><a href="#cb16-88"></a></span>
<span id="cb16-91"><a href="#cb16-91"></a><span class="in">```{r}</span></span>
<span id="cb16-92"><a href="#cb16-92"></a><span class="co">#| eval: true</span></span>
<span id="cb16-93"><a href="#cb16-93"></a><span class="co">#| echo: true</span></span>
<span id="cb16-94"><a href="#cb16-94"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-95"><a href="#cb16-95"></a><span class="co">#| label: fig5-3</span></span>
<span id="cb16-96"><a href="#cb16-96"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-97"><a href="#cb16-97"></a><span class="co">#| fig.cap: "基本散点图-修改散点大小"</span></span>
<span id="cb16-98"><a href="#cb16-98"></a></span>
<span id="cb16-99"><a href="#cb16-99"></a><span class="co"># load package</span></span>
<span id="cb16-100"><a href="#cb16-100"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-101"><a href="#cb16-101"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb16-102"><a href="#cb16-102"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb16-103"><a href="#cb16-103"></a></span>
<span id="cb16-104"><a href="#cb16-104"></a><span class="co"># 列出我们绘制散点图要用到的两列的标题</span></span>
<span id="cb16-105"><a href="#cb16-105"></a>heightweight <span class="sc">%&gt;%</span> </span>
<span id="cb16-106"><a href="#cb16-106"></a>  <span class="fu">select</span>(ageYear, heightIn)</span>
<span id="cb16-107"><a href="#cb16-107"></a></span>
<span id="cb16-108"><a href="#cb16-108"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb16-109"><a href="#cb16-109"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>)</span>
<span id="cb16-110"><a href="#cb16-110"></a><span class="in">```</span></span>
<span id="cb16-111"><a href="#cb16-111"></a></span>
<span id="cb16-112"><a href="#cb16-112"></a><span class="fu">## 使用点形或颜色属性对数据点进行分组</span></span>
<span id="cb16-113"><a href="#cb16-113"></a></span>
<span id="cb16-114"><a href="#cb16-114"></a>将分组变量映射到点形（<span class="in">`shape`</span>）或颜色（<span class="in">`colour`</span>）属性。</span>
<span id="cb16-115"><a href="#cb16-115"></a></span>
<span id="cb16-116"><a href="#cb16-116"></a>接下来的例子中，我们将用到 <span class="in">`heightweight`</span> 数据集中的3列。</span>
<span id="cb16-117"><a href="#cb16-117"></a></span>
<span id="cb16-120"><a href="#cb16-120"></a><span class="in">```{r}</span></span>
<span id="cb16-121"><a href="#cb16-121"></a><span class="co">#| eval: true</span></span>
<span id="cb16-122"><a href="#cb16-122"></a><span class="co">#| echo: true</span></span>
<span id="cb16-123"><a href="#cb16-123"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-124"><a href="#cb16-124"></a><span class="co">#| label: fig5-4</span></span>
<span id="cb16-125"><a href="#cb16-125"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-126"><a href="#cb16-126"></a><span class="co">#| fig-cap: "基本散点图-按形/色分组"</span></span>
<span id="cb16-127"><a href="#cb16-127"></a><span class="co">#| fig-subcap:</span></span>
<span id="cb16-128"><a href="#cb16-128"></a><span class="co">#|   - "按颜色分组"</span></span>
<span id="cb16-129"><a href="#cb16-129"></a><span class="co">#|   - "按形状分组" </span></span>
<span id="cb16-130"><a href="#cb16-130"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb16-131"><a href="#cb16-131"></a><span class="co">#| column: page-right</span></span>
<span id="cb16-132"><a href="#cb16-132"></a></span>
<span id="cb16-133"><a href="#cb16-133"></a><span class="co"># load package</span></span>
<span id="cb16-134"><a href="#cb16-134"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-135"><a href="#cb16-135"></a><span class="fu">library</span>(gcookbook) <span class="co"># 加载gcookbook是为了使用heightweight数据集</span></span>
<span id="cb16-136"><a href="#cb16-136"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb16-137"><a href="#cb16-137"></a></span>
<span id="cb16-138"><a href="#cb16-138"></a><span class="co"># 列出要用到的3列的标题</span></span>
<span id="cb16-139"><a href="#cb16-139"></a>heightweight <span class="sc">%&gt;%</span></span>
<span id="cb16-140"><a href="#cb16-140"></a>  <span class="fu">select</span>(sex, ageYear, heightIn)</span>
<span id="cb16-141"><a href="#cb16-141"></a><span class="co">#&gt;     sex ageYear heightIn</span></span>
<span id="cb16-142"><a href="#cb16-142"></a><span class="co">#&gt; 1     f   11.92     56.3</span></span>
<span id="cb16-143"><a href="#cb16-143"></a><span class="co">#&gt; 2     f   12.92     62.3</span></span>
<span id="cb16-144"><a href="#cb16-144"></a><span class="co">#&gt; 3     f   12.75     63.3</span></span>
<span id="cb16-145"><a href="#cb16-145"></a><span class="co">#&gt;  ...&lt;230 more rows&gt;...</span></span>
<span id="cb16-146"><a href="#cb16-146"></a><span class="co">#&gt; 235   m   13.67     61.5</span></span>
<span id="cb16-147"><a href="#cb16-147"></a><span class="co">#&gt; 236   m   13.92     62.0</span></span>
<span id="cb16-148"><a href="#cb16-148"></a><span class="co">#&gt; 237   m   12.58     59.3</span></span>
<span id="cb16-149"><a href="#cb16-149"></a></span>
<span id="cb16-150"><a href="#cb16-150"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn,<span class="at">color =</span> sex)) <span class="sc">+</span> </span>
<span id="cb16-151"><a href="#cb16-151"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb16-152"><a href="#cb16-152"></a></span>
<span id="cb16-153"><a href="#cb16-153"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn,<span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb16-154"><a href="#cb16-154"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb16-155"><a href="#cb16-155"></a><span class="in">```</span></span>
<span id="cb16-156"><a href="#cb16-156"></a></span>
<span id="cb16-157"><a href="#cb16-157"></a>选用的分组变量必须是分类变量，换言之，它必须是因子型或者字符型的向量。如果分组变量是数值型向量，则需要将它转化为因子型变量之后，才能以其作为分组变量。</span>
<span id="cb16-158"><a href="#cb16-158"></a></span>
<span id="cb16-159"><a href="#cb16-159"></a>可以将一个变量同时映射到 <span class="in">`shape`</span> 和 <span class="in">`colour`</span> 属性。当有多个分组变量时，可以将它们分别映射到不同的图形属性。下面，我们把变量 <span class="in">`sex`</span> 同时映射到 <span class="in">`shape`</span> 和 <span class="in">`colour`</span> 属性，见图 @fig5-5 。</span>
<span id="cb16-160"><a href="#cb16-160"></a></span>
<span id="cb16-163"><a href="#cb16-163"></a><span class="in">```{r}</span></span>
<span id="cb16-164"><a href="#cb16-164"></a><span class="co">#| eval: true</span></span>
<span id="cb16-165"><a href="#cb16-165"></a><span class="co">#| echo: true</span></span>
<span id="cb16-166"><a href="#cb16-166"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-167"><a href="#cb16-167"></a><span class="co">#| label: fig5-5</span></span>
<span id="cb16-168"><a href="#cb16-168"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-169"><a href="#cb16-169"></a><span class="co">#| fig-cap: "基本散点图-按形和色分组"</span></span>
<span id="cb16-170"><a href="#cb16-170"></a></span>
<span id="cb16-171"><a href="#cb16-171"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn,<span class="at">color =</span> sex,<span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb16-172"><a href="#cb16-172"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb16-173"><a href="#cb16-173"></a><span class="in">```</span></span>
<span id="cb16-174"><a href="#cb16-174"></a></span>
<span id="cb16-175"><a href="#cb16-175"></a>有时需要使用不同于默认设置的点形和颜色。通过调用<span class="in">`scale_shape_manual()`</span> 函数可以使用其他点形；</span>
<span id="cb16-176"><a href="#cb16-176"></a></span>
<span id="cb16-177"><a href="#cb16-177"></a>调用 <span class="in">`scale_colour_brewer()`</span> 函数或者 <span class="in">`scale_colour_manual()`</span> 函数可以使用其他调色板，见图 @fig5-6 。</span>
<span id="cb16-178"><a href="#cb16-178"></a></span>
<span id="cb16-181"><a href="#cb16-181"></a><span class="in">```{r}</span></span>
<span id="cb16-182"><a href="#cb16-182"></a><span class="co">#| eval: true</span></span>
<span id="cb16-183"><a href="#cb16-183"></a><span class="co">#| echo: true</span></span>
<span id="cb16-184"><a href="#cb16-184"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-185"><a href="#cb16-185"></a><span class="co">#| label: fig5-6</span></span>
<span id="cb16-186"><a href="#cb16-186"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-187"><a href="#cb16-187"></a><span class="co">#| fig-cap: "基本散点图-修改调色板"</span></span>
<span id="cb16-188"><a href="#cb16-188"></a></span>
<span id="cb16-189"><a href="#cb16-189"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn, <span class="at">shape =</span> sex, <span class="at">colour =</span> sex)) <span class="sc">+</span> </span>
<span id="cb16-190"><a href="#cb16-190"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-191"><a href="#cb16-191"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb16-192"><a href="#cb16-192"></a>  <span class="fu">scale_colour_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>)</span>
<span id="cb16-193"><a href="#cb16-193"></a><span class="in">```</span></span>
<span id="cb16-194"><a href="#cb16-194"></a></span>
<span id="cb16-195"><a href="#cb16-195"></a><span class="fu">## 使用不同于默认设置的点形</span></span>
<span id="cb16-196"><a href="#cb16-196"></a></span>
<span id="cb16-197"><a href="#cb16-197"></a>通过指定 <span class="in">`geom_point()`</span> 函数中的点形（<span class="in">`shape`</span>）参数，可以同时设定散点图中所有数据点的点形，如图 @fig5-7 所示。</span>
<span id="cb16-198"><a href="#cb16-198"></a></span>
<span id="cb16-201"><a href="#cb16-201"></a><span class="in">```{r}</span></span>
<span id="cb16-202"><a href="#cb16-202"></a><span class="co">#| eval: true</span></span>
<span id="cb16-203"><a href="#cb16-203"></a><span class="co">#| echo: true</span></span>
<span id="cb16-204"><a href="#cb16-204"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-205"><a href="#cb16-205"></a><span class="co">#| label: fig5-7</span></span>
<span id="cb16-206"><a href="#cb16-206"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-207"><a href="#cb16-207"></a><span class="co">#| fig-cap: "指定散点形状"</span></span>
<span id="cb16-208"><a href="#cb16-208"></a></span>
<span id="cb16-209"><a href="#cb16-209"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn)) <span class="sc">+</span> </span>
<span id="cb16-210"><a href="#cb16-210"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">3</span>)</span>
<span id="cb16-211"><a href="#cb16-211"></a><span class="in">```</span></span>
<span id="cb16-212"><a href="#cb16-212"></a></span>
<span id="cb16-213"><a href="#cb16-213"></a>R系统绘图可以调用的图形较多，一些点形只有边框线（1～14）​；一些只有实心填充区域（15～20）​；还有一些则由可分离的边框线和具有填充色的实心区域共同组成（21～25）​，也可以用字符作点形。</span>
<span id="cb16-214"><a href="#cb16-214"></a></span>
<span id="cb16-215"><a href="#cb16-215"></a>如果已将分组变量映射到 <span class="in">`shape`</span>，则可以调用 <span class="in">`scale_shape_manual()`</span> 函数来手动修改该分组变量不同水平的点形</span>
<span id="cb16-216"><a href="#cb16-216"></a></span>
<span id="cb16-217"><a href="#cb16-217"></a>下图将使用略大且自定义点形的数据点：</span>
<span id="cb16-218"><a href="#cb16-218"></a></span>
<span id="cb16-221"><a href="#cb16-221"></a><span class="in">```{r}</span></span>
<span id="cb16-222"><a href="#cb16-222"></a><span class="co">#| eval: true</span></span>
<span id="cb16-223"><a href="#cb16-223"></a><span class="co">#| echo: true</span></span>
<span id="cb16-224"><a href="#cb16-224"></a><span class="co">#| code-fold: false</span></span>
<span id="cb16-225"><a href="#cb16-225"></a><span class="co">#| label: fig5-8</span></span>
<span id="cb16-226"><a href="#cb16-226"></a><span class="co">#| fig: TRUE</span></span>
<span id="cb16-227"><a href="#cb16-227"></a><span class="co">#| fig-cap: "自定义散点形状"</span></span>
<span id="cb16-228"><a href="#cb16-228"></a></span>
<span id="cb16-229"><a href="#cb16-229"></a><span class="fu">ggplot</span>(heightweight, <span class="fu">aes</span>(<span class="at">x =</span> ageYear, <span class="at">y =</span> heightIn, <span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb16-230"><a href="#cb16-230"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb16-231"><a href="#cb16-231"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>))</span>
<span id="cb16-232"><a href="#cb16-232"></a><span class="in">```</span></span>
<span id="cb16-233"><a href="#cb16-233"></a></span>
<span id="cb16-234"><a href="#cb16-234"></a><span class="ss">-   </span>点形1～20的点的颜色，包括实心区域的颜色都可由 <span class="in">`colour`</span> 参数来控制。</span>
<span id="cb16-235"><a href="#cb16-235"></a></span>
<span id="cb16-236"><a href="#cb16-236"></a><span class="ss">-   </span>对于点形21～25而言，边框线和实心区域的颜色则分别由 <span class="in">`colour`</span> 和 <span class="in">`fill`</span> 参数来控制。</span>
<span id="cb16-237"><a href="#cb16-237"></a></span>
<span id="cb16-238"><a href="#cb16-238"></a>我们可以将两个不同的变量分别由点形和填充色（空心或有填充）属性来表示。</span>
<span id="cb16-239"><a href="#cb16-239"></a></span>
<span id="cb16-240"><a href="#cb16-240"></a>为了实现这一功能，首先需要选择一个同时具有 <span class="in">`colour`</span> 和 <span class="in">`fill`</span> 属性的点形，在 <span class="in">`scale_shape_manual`</span> 中设定。之后需要在<span class="in">`scale_fill_manual()`</span> 中选择一个包括 NA 和其他颜色的调色板（NA会生成一个空心的形状）​。</span>
</code><button title="复制到剪贴板" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
<li class="nav-item">
 This website was built with Quarto
  </li>  
</ul>
</div>   
    <div class="nav-footer-center">
<p>Copyright 2023-2025, LB.ZHOU</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/pumc-zhou/Med-Stat-Notes/blob/main/Guide/R/05-ggplot2-scatter-plot.qmd" class="toc-action"><i class="bi bi-github"></i>查看代码</a></li><li><a href="https://github.com/pumc-zhou/Med-Stat-Notes/issues/new" class="toc-action"><i class="bi empty"></i>反馈问题</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/pumc-zhou/Med-Stat-Notes">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>