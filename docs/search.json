[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "医学统计学习笔记",
    "section": "",
    "text": "本书的前身是开始于23年暑假的Rmarkdown笔记的制作，在考研的过程中，一些无聊又不想学习的时间被用来整理这些笔记和制作文档与网页，由于Quarto的出现和发展，感觉到它的强大与便利，遂用Quarto重制。\n现在重制这本学习笔记，按照初步构想，会继续完善卫生/医学统计学部分的内容，从低阶往高阶完善；再就是记录相关程序的使用技巧和学习记录（R、Python、SAS etc.)；还有有一部分的项目分享（如果顺利的话）和读书报告。\nEpidemiologists, in response to a health emergency or as a result of systematic surveillance, first obtain and analyze observed data. They use data, observations, science, and theory as they work at identifying a pathogen (when unknown) behind an observed disease outbreak or as they proceed to plan or implement policies that ameliorates its impact.\n按照大类再细分的话会有如下：\n\n统计学\n\n医学统计学（基础篇）\n贝叶斯统计\n最大似然统计\n\n统计软件的使用\n\nR\nPython\nSAS\nStata\nQuarto\n\n项目记录\n\nKaggle\n\n读书笔记\n\n\n\nCitationBibTeX citation:@online{2025,\n  author = {, simonzhou},\n  title = {医学统计学习笔记},\n  date = {2025-02-21},\n  url = {https://github.com/zhoulvbang/Med-Stat-Notes},\n  langid = {en}\n}\nFor attribution, please cite this work as:\nsimonzhou. 2025. “医学统计学习笔记.” February 21, 2025. https://github.com/zhoulvbang/Med-Stat-Notes.",
    "crumbs": [
      "Home",
      "主页"
    ]
  },
  {
    "objectID": "statistics-basic/test.html",
    "href": "statistics-basic/test.html",
    "title": "初识医学统计学",
    "section": "",
    "text": "rmarkdown",
    "crumbs": [
      "Home",
      "医学统计学基础",
      "初识医学统计学"
    ]
  },
  {
    "objectID": "Quarto/yaml_settings.html",
    "href": "Quarto/yaml_settings.html",
    "title": "YAML设置",
    "section": "",
    "text": "Quarto主要由三大部分组成：metadata, text, 和 code。其中metadata是文档开头写在”—“之间的句子，它采用的是YAML语法，所以有时候也被叫做YAML metadata 或者 the YAML frontmatter。YAML定义了Quarto文档的各种属性，比如编译文件类型、主题、代码块的执行行为以及目录等。在YAML metadata中采用正确的缩进十分重要。",
    "crumbs": [
      "Home",
      "Quarto introduction",
      "YAML设置"
    ]
  },
  {
    "objectID": "Quarto/yaml_settings.html#sec-dateformat",
    "href": "Quarto/yaml_settings.html#sec-dateformat",
    "title": "YAML设置",
    "section": "\n2.1 date-format的设置",
    "text": "2.1 date-format的设置\ndate-format通过以下关键词来定义日期格式：\n\n\n\n\n\n\n\nStyle\nDescription\nExample\n\n\n\nfull\nA full date that includes the weekday name\nMonday, March 7, 2005\n\n\nlong\nA long date that includes a wide month name\nMarch 7, 2005\n\n\nmedium\nA medium date\nMar 7, 2005\n\n\nshort\nA short date with a numeric month\n3/7/05\n\n\niso\nA short date in ISO format\n2005-03-07\n\n\n\n也可以通过以下语法更加灵活的定义日期格式：\n\n\n\n\n\n\n\normat String\nOutput\nDescription\n\n\n\nYY\n18\nTwo-digit year\n\n\nYYYY\n2018\n四位数年份\n\n\nM\n1-12\nThe month, beginning at 1\n\n\nMM\n01-12\n两位数月份\n\n\nMMM\nJan-Dec\nThe abbreviated month name\n\n\nMMMM\nJanuary-December\nThe full month name\n\n\nD\n1-31\nThe day of the month\n\n\nDD\n01-31\n两位数日期\n\n\nd\n0-6\nThe day of the week, with Sunday as 0\n\n\ndd\nSu-Sa\nThe min name of the day of the week\n\n\nddd\nSun-Sat\nThe short name of the day of the week\n\n\ndddd\nSunday-Saturday\nThe name of the day of the week\n\n\nH\n0-23\nThe hour\n\n\nHH\n00-23\n两位数小时，24小时制\n\n\nh\n1-12\nThe hour, 12-hour clock\n\n\nhh\n01-12\nThe hour, 12-hour clock, 2-digits\n\n\nm\n0-59\nThe minute\n\n\nmm\n00-59\n两位数分钟\n\n\ns\n0-59\nThe second\n\n\nss\n00-59\nThe second, 2-digits\n\n\nSSS\n000-999\nThe millisecond, 3-digits\n\n\nZ\n+05:00\nThe offset from UTC, ±HH:mm\n\n\nA\nAM PM\n\n\n\na\nam pm\n\n\n\nDo\n1st 2nd … 31st\nDay of Month with ordinal\n\n\n\n可以通过”[]“添加自定义字符。通过这些语法，可以定制符合中文语法的日期格式，如：date-format: \"YYYY[年]M[月]D[日] HH:mm\"\n\n\n\n\n\n\nTip\n\n\n\n关于日期的详细指南，详见：https://quarto.org/docs/reference/dates.html。",
    "crumbs": [
      "Home",
      "Quarto introduction",
      "YAML设置"
    ]
  },
  {
    "objectID": "Quarto/yaml_settings.html#编译html",
    "href": "Quarto/yaml_settings.html#编译html",
    "title": "YAML设置",
    "section": "\n10.1 编译HTML",
    "text": "10.1 编译HTML\n\n---\nformat: \n  html:\n    theme: \n      light: flatly \n      dark: darkly \n    embed-resources: false\n    code-tools: true\n    title-block-banner: images/banner.jpg \n    title-block-banner-color: \"black\"\n    toc: true\n    toc-title: 目录\n    toc-location: left\n    toc-depth: 2\n    toc-expand: 1\n    number-sections: true\n    number-depth: 3\n    anchor-sections: true\n    link-external-icon: true\n    link-external-newwindow: true\n    df-print: kable \n    code-link: true\n---\n\n\ntheme：主题。同 Section 3 。\nembed-resources：是否将所有源文件嵌入HTML文件以方便分享。默认为”false”。\ncode-tools：是否在网页右上角显示”&lt;code&gt;“按钮。点击该按钮可以看到Quarto文档的原始markdown代码。\n\ntitle-block-banner：标题横幅设置。title-block-banner有以下选项：\n\ntrue：将标题以网页横幅的形式展示，样式为them中所选样式的默认样式。\n具体颜色：如title-block-banner: \"#003262\"。\n图片路径：如title-block-banner: images/banner.jpeg。\n\n\ntoc相关设置：同 Section 4 。\nnumber-sections、number-depth：同 Section 5 。\nanchor-sections: 设置为true时，当鼠标移到各级标题上时会显示anchor link，方便我们复制直接定位到该标题的超链接。\nlink-external-icon：设置为true时会在外部链接上显示一个小图标。\nlink-external-newwindow：是否在新标签页打开外部链接。\ndf-print：表格输出样式\n\ncode-copy：设置代码复制按钮：\n\ntrue: 总是在代码块右上角显示代码复制按钮。\nfalse: 隐藏代码复制按钮。\nhover：（默认）当鼠标移过时显示代码复制按钮。\n\n\ncode-fold: 是否折叠代码。\ncode-link: 是否自动为函数加上超链接。该功能基于downlit包，可以自动为识别到的函数加上一个链接到官方文档的超链接。",
    "crumbs": [
      "Home",
      "Quarto introduction",
      "YAML设置"
    ]
  },
  {
    "objectID": "Quarto/yaml_settings.html#sec-github-markdown",
    "href": "Quarto/yaml_settings.html#sec-github-markdown",
    "title": "YAML设置",
    "section": "\n10.2 编译GitHub Flavored Markdown（GFM）",
    "text": "10.2 编译GitHub Flavored Markdown（GFM）\n我们可以将Quarto文档转换为GitHub风格的Markdown文档（GitHub Flavored Markdown，GFM）。这可以用来生成GitHub项目的README.md文档。\n\n---\ntitle: \"My Project\"\nformat: \n  gfm:\n    identifier-prefix: readme # 标识符\n    # preview-mode: raw # 预览原始markdown\n    keep-yaml: true\n    toc: true\n    toc-depth: 1\n    number-sections: true\n    citation-location: document\n    output-file: \"README.md\" # 输出文档的文件名\n---",
    "crumbs": [
      "Home",
      "Quarto introduction",
      "YAML设置"
    ]
  },
  {
    "objectID": "Quarto/yaml_settings.html#编译pdf",
    "href": "Quarto/yaml_settings.html#编译pdf",
    "title": "YAML设置",
    "section": "\n10.3 编译PDF",
    "text": "10.3 编译PDF\n如果要在rmarkdown、bookdown中使用PDF输出功能， 可以在在R中安装tinytex扩展包并安装TinyTeX编译软件：\n\ninstall.packages('tinytex')\ntinytex::install_tinytex()\n\n其中上面第一行命令安装R的tinytex扩展包， 第二行将下载LaTeX编译程序的服务器设置为清华大学tuna镜像站， 第三行安装LaTeX编译程序。\n如果安装成功， TinyTeX软件包在MS Windows系统中一般会安装在 C:\\Users\\用户名\\AppData\\Roaming\\TinyTeX目录中， 其中”用户名”应替换成系统当前用户名。 如果需要删除TinyTeX软件包， 只要直接删除那个子目录就可以。\n为了判断TinyTeX是否安装成功， 在RStudio中运行：\n\ntinytex::is_tinytex()\n\n结果应为TRUE, 出错或者结果为FALSE都说明安装不成功。\n当用户使用RMarkdown和tinytex包转换latex并编译为PDF时， 如果缺少某些latex宏包， tinytex会自动安装缺少的宏包。",
    "crumbs": [
      "Home",
      "Quarto introduction",
      "YAML设置"
    ]
  },
  {
    "objectID": "Guide/SAS/SAS-intro.html",
    "href": "Guide/SAS/SAS-intro.html",
    "title": "SAS introduction",
    "section": "",
    "text": "SAS introduction",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "SAS introduction"
    ]
  },
  {
    "objectID": "Guide/R/R-intro.html",
    "href": "Guide/R/R-intro.html",
    "title": "R introduction",
    "section": "",
    "text": "R的介绍",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "R introduction"
    ]
  },
  {
    "objectID": "Guide/Guide-intro.html",
    "href": "Guide/Guide-intro.html",
    "title": "统计软件使用指南",
    "section": "",
    "text": "一些统计软件的使用",
    "crumbs": [
      "Home",
      "统计软件使用指南"
    ]
  },
  {
    "objectID": "Guide/R/R-install.html",
    "href": "Guide/R/R-install.html",
    "title": "R install",
    "section": "",
    "text": "R的安装",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "R introduction",
      "R install"
    ]
  },
  {
    "objectID": "Guide/SAS/SAS-install.html",
    "href": "Guide/SAS/SAS-install.html",
    "title": "SAS Install",
    "section": "",
    "text": "SAS Install",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "SAS introduction",
      "SAS Install"
    ]
  },
  {
    "objectID": "Quarto/quarto-intro.html",
    "href": "Quarto/quarto-intro.html",
    "title": "Quarto introduction",
    "section": "",
    "text": "Quarto introduction",
    "crumbs": [
      "Home",
      "Quarto introduction"
    ]
  },
  {
    "objectID": "statistics-basic/statistics-basic.html",
    "href": "statistics-basic/statistics-basic.html",
    "title": "医学统计学基础",
    "section": "",
    "text": "本章主要介绍基本的医学统计学内容，主要参照内容为：人卫第八版《卫生统计学》、科社第二版《医学统计学（基础版）》。\n\n章节主要分布如下：\n\n绪论\n\n医学统计学\n统计学的基本概念\n统计学在医学科研中的基本步骤\n统计学与相关学科的关系\n\n描述性统计\n随机事件与概率\n离散型随机变量\n连续型随机变量\n参数估计\n一个正态总体参数的假设检验\n两个正态总体参数的假设检验\n单因素方差分析\n多因素方差分析\n\\(\\chi^2\\)检验\n基于秩次的非参数检验\n一元线性回归\n相关分析",
    "crumbs": [
      "Home",
      "医学统计学基础"
    ]
  },
  {
    "objectID": "solana/index.html",
    "href": "solana/index.html",
    "title": "Sigríður Björndotter",
    "section": "",
    "text": "Sigríður Björndotter is a musician, vocalist, and live entertainment consultant living in Buenos Aires, Argentina. Her writing has appeared in Rolling Stone, Billboard, and NME, and she is a frequent contributor to National Public Radio’s All Songs Considered. She has been raising Pembroke Welsh Corgis since the age of six, and she has collected Casio watches since the age of ten."
  },
  {
    "objectID": "solana/index.html#bio",
    "href": "solana/index.html#bio",
    "title": "Sigríður Björndotter",
    "section": "",
    "text": "Sigríður Björndotter is a musician, vocalist, and live entertainment consultant living in Buenos Aires, Argentina. Her writing has appeared in Rolling Stone, Billboard, and NME, and she is a frequent contributor to National Public Radio’s All Songs Considered. She has been raising Pembroke Welsh Corgis since the age of six, and she has collected Casio watches since the age of ten."
  },
  {
    "objectID": "solana/index.html#education",
    "href": "solana/index.html#education",
    "title": "Sigríður Björndotter",
    "section": "\n2 Education",
    "text": "2 Education\nINSEAD | Fontainebleau, France\nM.B.A. | August 2014 - June 2015\nThe Juilliard School | New York, NY\nB.F.A. in Music Performance | August 2005 - May 2009"
  },
  {
    "objectID": "solana/index.html#experience",
    "href": "solana/index.html#experience",
    "title": "Sigríður Björndotter",
    "section": "\n3 Experience",
    "text": "3 Experience\nFreelance | Live Entertainment Consultant | August 2018 - Present\nCercle | Producer | August 2018 - Present\nNational Public Radio | Producer | May 2015 - July 2018\nNME Magazine | Editor | July 2014 - July 2016\nIceland Symphony Orchestra | Cellist | October 2009 - June 2014"
  },
  {
    "objectID": "statistics-basic/01-preview.html",
    "href": "statistics-basic/01-preview.html",
    "title": "Preview",
    "section": "",
    "text": "卫生统计学是一门致力于收集、分析和解释与健康相关的数据的学科。它的目标是通过统计方法来评估和改善人群的健康状况，从而提高公共卫生水平。卫生统计学将统计学原理应用于医学和公共卫生领域，以支持健康决策的制定和实施。\n\n\n\n卫生统计学在以下几个方面发挥着重要作用：\n\n疾病监测与控制： 通过收集和分析疾病发病率、死亡率和流行病学数据，卫生统计学帮助识别疾病的流行趋势，并制定相应的预防和控制策略。\n健康政策制定： 卫生统计学提供了评估不同健康政策和干预措施效果的方法，为政策制定者提供了决策支持。\n卫生服务评估： 通过分析卫生服务的覆盖范围、质量和效率，卫生统计学评估卫生系统的运作情况，并提供改进建议。\n流行病学研究： 卫生统计学在研究人群健康与疾病之间的关系方面发挥着关键作用，帮助揭示疾病的发病机制和影响因素。\n\n\n\n\n随着数据科学和人工智能技术的发展，卫生统计学将迎来新的机遇和挑战：\n\n大数据与人工智能： 大数据技术使得收集、整合和分析海量的健康数据成为可能，而人工智能技术则提供了更高效、精确的数据处理和预测能力，为卫生统计学研究提供了新的方法和工具。\n个性化医疗： 基于个体遗传信息和生活方式数据的个性化医疗将成为未来的发展趋势，卫生统计学将在个体化医疗决策和健康管理中发挥更加重要的作用。\n跨学科合作： 卫生统计学将与流行病学、遗传学、生物信息学等学科交叉融合，形成跨学科合作的新模式，共同解决健康领域的复杂问题。\n公众参与与健康促进： 卫生统计学将更加注重公众参与和社区健康促进，通过社会行为和环境因素的分析，促进健康政策的制定和实施，推动社会健康公平。\n\n随着社会的发展和健康需求的不断变化，卫生统计学将继续发挥着重要的作用，为促进全民健康、预防疾病、改善医疗服务质量和推动卫生政策提供支持和指导。"
  },
  {
    "objectID": "statistics-basic/01-preview.html#什么是卫生统计学",
    "href": "statistics-basic/01-preview.html#什么是卫生统计学",
    "title": "Preview",
    "section": "",
    "text": "卫生统计学是一门致力于收集、分析和解释与健康相关的数据的学科。它的目标是通过统计方法来评估和改善人群的健康状况，从而提高公共卫生水平。卫生统计学将统计学原理应用于医学和公共卫生领域，以支持健康决策的制定和实施。"
  },
  {
    "objectID": "statistics-basic/01-preview.html#卫生统计学的重要性",
    "href": "statistics-basic/01-preview.html#卫生统计学的重要性",
    "title": "Preview",
    "section": "",
    "text": "卫生统计学在以下几个方面发挥着重要作用：\n\n疾病监测与控制： 通过收集和分析疾病发病率、死亡率和流行病学数据，卫生统计学帮助识别疾病的流行趋势，并制定相应的预防和控制策略。\n健康政策制定： 卫生统计学提供了评估不同健康政策和干预措施效果的方法，为政策制定者提供了决策支持。\n卫生服务评估： 通过分析卫生服务的覆盖范围、质量和效率，卫生统计学评估卫生系统的运作情况，并提供改进建议。\n流行病学研究： 卫生统计学在研究人群健康与疾病之间的关系方面发挥着关键作用，帮助揭示疾病的发病机制和影响因素。"
  },
  {
    "objectID": "statistics-basic/01-preview.html#卫生统计学的未来展望",
    "href": "statistics-basic/01-preview.html#卫生统计学的未来展望",
    "title": "Preview",
    "section": "",
    "text": "随着数据科学和人工智能技术的发展，卫生统计学将迎来新的机遇和挑战：\n\n大数据与人工智能： 大数据技术使得收集、整合和分析海量的健康数据成为可能，而人工智能技术则提供了更高效、精确的数据处理和预测能力，为卫生统计学研究提供了新的方法和工具。\n个性化医疗： 基于个体遗传信息和生活方式数据的个性化医疗将成为未来的发展趋势，卫生统计学将在个体化医疗决策和健康管理中发挥更加重要的作用。\n跨学科合作： 卫生统计学将与流行病学、遗传学、生物信息学等学科交叉融合，形成跨学科合作的新模式，共同解决健康领域的复杂问题。\n公众参与与健康促进： 卫生统计学将更加注重公众参与和社区健康促进，通过社会行为和环境因素的分析，促进健康政策的制定和实施，推动社会健康公平。\n\n随着社会的发展和健康需求的不断变化，卫生统计学将继续发挥着重要的作用，为促进全民健康、预防疾病、改善医疗服务质量和推动卫生政策提供支持和指导。"
  },
  {
    "objectID": "Learn/Basic/test.html",
    "href": "Learn/Basic/test.html",
    "title": "初识医学统计学",
    "section": "",
    "text": "rmarkdown",
    "crumbs": [
      "Home",
      "医学统计学基础",
      "医学统计学基础",
      "初识医学统计学"
    ]
  },
  {
    "objectID": "Learn/Basic/01-preview.html",
    "href": "Learn/Basic/01-preview.html",
    "title": "Preview",
    "section": "",
    "text": "卫生统计学是一门致力于收集、分析和解释与健康相关的数据的学科。它的目标是通过统计方法来评估和改善人群的健康状况，从而提高公共卫生水平。卫生统计学将统计学原理应用于医学和公共卫生领域，以支持健康决策的制定和实施。\n\n\n\n卫生统计学在以下几个方面发挥着重要作用：\n\n疾病监测与控制： 通过收集和分析疾病发病率、死亡率和流行病学数据，卫生统计学帮助识别疾病的流行趋势，并制定相应的预防和控制策略。\n健康政策制定： 卫生统计学提供了评估不同健康政策和干预措施效果的方法，为政策制定者提供了决策支持。\n卫生服务评估： 通过分析卫生服务的覆盖范围、质量和效率，卫生统计学评估卫生系统的运作情况，并提供改进建议。\n流行病学研究： 卫生统计学在研究人群健康与疾病之间的关系方面发挥着关键作用，帮助揭示疾病的发病机制和影响因素。\n\n\n\n\n随着数据科学和人工智能技术的发展，卫生统计学将迎来新的机遇和挑战：\n\n大数据与人工智能： 大数据技术使得收集、整合和分析海量的健康数据成为可能，而人工智能技术则提供了更高效、精确的数据处理和预测能力，为卫生统计学研究提供了新的方法和工具。\n个性化医疗： 基于个体遗传信息和生活方式数据的个性化医疗将成为未来的发展趋势，卫生统计学将在个体化医疗决策和健康管理中发挥更加重要的作用。\n跨学科合作： 卫生统计学将与流行病学、遗传学、生物信息学等学科交叉融合，形成跨学科合作的新模式，共同解决健康领域的复杂问题。\n公众参与与健康促进： 卫生统计学将更加注重公众参与和社区健康促进，通过社会行为和环境因素的分析，促进健康政策的制定和实施，推动社会健康公平。\n\n随着社会的发展和健康需求的不断变化，卫生统计学将继续发挥着重要的作用，为促进全民健康、预防疾病、改善医疗服务质量和推动卫生政策提供支持和指导。",
    "crumbs": [
      "Home",
      "医学统计学基础",
      "医学统计学基础",
      "Preview"
    ]
  },
  {
    "objectID": "Learn/Basic/01-preview.html#什么是卫生统计学",
    "href": "Learn/Basic/01-preview.html#什么是卫生统计学",
    "title": "Preview",
    "section": "",
    "text": "卫生统计学是一门致力于收集、分析和解释与健康相关的数据的学科。它的目标是通过统计方法来评估和改善人群的健康状况，从而提高公共卫生水平。卫生统计学将统计学原理应用于医学和公共卫生领域，以支持健康决策的制定和实施。",
    "crumbs": [
      "Home",
      "医学统计学基础",
      "医学统计学基础",
      "Preview"
    ]
  },
  {
    "objectID": "Learn/Basic/01-preview.html#卫生统计学的重要性",
    "href": "Learn/Basic/01-preview.html#卫生统计学的重要性",
    "title": "Preview",
    "section": "",
    "text": "卫生统计学在以下几个方面发挥着重要作用：\n\n疾病监测与控制： 通过收集和分析疾病发病率、死亡率和流行病学数据，卫生统计学帮助识别疾病的流行趋势，并制定相应的预防和控制策略。\n健康政策制定： 卫生统计学提供了评估不同健康政策和干预措施效果的方法，为政策制定者提供了决策支持。\n卫生服务评估： 通过分析卫生服务的覆盖范围、质量和效率，卫生统计学评估卫生系统的运作情况，并提供改进建议。\n流行病学研究： 卫生统计学在研究人群健康与疾病之间的关系方面发挥着关键作用，帮助揭示疾病的发病机制和影响因素。",
    "crumbs": [
      "Home",
      "医学统计学基础",
      "医学统计学基础",
      "Preview"
    ]
  },
  {
    "objectID": "Learn/Basic/01-preview.html#卫生统计学的未来展望",
    "href": "Learn/Basic/01-preview.html#卫生统计学的未来展望",
    "title": "Preview",
    "section": "",
    "text": "随着数据科学和人工智能技术的发展，卫生统计学将迎来新的机遇和挑战：\n\n大数据与人工智能： 大数据技术使得收集、整合和分析海量的健康数据成为可能，而人工智能技术则提供了更高效、精确的数据处理和预测能力，为卫生统计学研究提供了新的方法和工具。\n个性化医疗： 基于个体遗传信息和生活方式数据的个性化医疗将成为未来的发展趋势，卫生统计学将在个体化医疗决策和健康管理中发挥更加重要的作用。\n跨学科合作： 卫生统计学将与流行病学、遗传学、生物信息学等学科交叉融合，形成跨学科合作的新模式，共同解决健康领域的复杂问题。\n公众参与与健康促进： 卫生统计学将更加注重公众参与和社区健康促进，通过社会行为和环境因素的分析，促进健康政策的制定和实施，推动社会健康公平。\n\n随着社会的发展和健康需求的不断变化，卫生统计学将继续发挥着重要的作用，为促进全民健康、预防疾病、改善医疗服务质量和推动卫生政策提供支持和指导。",
    "crumbs": [
      "Home",
      "医学统计学基础",
      "医学统计学基础",
      "Preview"
    ]
  },
  {
    "objectID": "Learn/Basic/statistics-basic.html",
    "href": "Learn/Basic/statistics-basic.html",
    "title": "医学统计学基础",
    "section": "",
    "text": "本章主要介绍基本的医学统计学内容，主要参照内容为：人卫第八版《卫生统计学》、科社第二版《医学统计学（基础版）》。\n\n章节主要分布如下：\n\n绪论\n\n医学统计学\n统计学的基本概念\n统计学在医学科研中的基本步骤\n统计学与相关学科的关系\n\n描述性统计\n随机事件与概率\n离散型随机变量\n连续型随机变量\n参数估计\n一个正态总体参数的假设检验\n两个正态总体参数的假设检验\n单因素方差分析\n多因素方差分析\n\\(\\chi^2\\)检验\n基于秩次的非参数检验\n一元线性回归\n相关分析",
    "crumbs": [
      "Home",
      "Learn/statistics-basic/statistics-basic.qmd",
      "医学统计学基础"
    ]
  },
  {
    "objectID": "navbar/book.html",
    "href": "navbar/book.html",
    "title": "医学统计学习推荐书籍与网站",
    "section": "",
    "text": "读的书有点乱，主要都在微信读书看，部分是纸质书。\n对于刚接触统计的朋友，可以先看看《女士品茶：统计学如何变革了科学和生活》这本书，也会他能激发你的一些对于统计学（家们）的兴趣，通过一些有趣的小故事，带你走进统计学的世界。"
  },
  {
    "objectID": "Learn/Basic/00-basic.html",
    "href": "Learn/Basic/00-basic.html",
    "title": "医学统计学基础",
    "section": "",
    "text": "本章主要介绍基本的医学统计学内容，主要参照内容为：人卫第八版《卫生统计学》、科社第二版《医学统计学（基础版）》。\n\n章节主要分布如下：\n\n绪论\n\n医学统计学\n统计学的基本概念\n统计学在医学科研中的基本步骤\n统计学与相关学科的关系\n\n描述性统计\n随机事件与概率\n离散型随机变量\n连续型随机变量\n参数估计\n一个正态总体参数的假设检验\n两个正态总体参数的假设检验\n单因素方差分析\n多因素方差分析\n\\(\\chi^2\\)检验\n基于秩次的非参数检验\n一元线性回归\n相关分析",
    "crumbs": [
      "Home",
      "医学统计学基础"
    ]
  },
  {
    "objectID": "Guide/Python/2025-02-20-Medical-expenses.html",
    "href": "Guide/Python/2025-02-20-Medical-expenses.html",
    "title": "处理一份医疗数据",
    "section": "",
    "text": "本篇博客用来记录2025年1月到2月帮助学弟处理一份某二级医院2018-2023年的医疗费用，最开始用的Stata，但是越往后，越感觉到Stata的难用，以及AI对这种程序的支持程度极其有限，随改用Python来继续完成相关的分析。\n\n\n运行此文档需要电脑上以安装Python，并且下列包已被安装并且能被调用：\njupyter-cache,pandas,openpuxl\n你可以使用 pip 或 conda 进行安装： pip install jupyter-cache\n\n\n\n我们可以使用pandas包来查看部分原始数据，数据的基本样式如下：\n\n# 安装并加载必要的包\nimport pandas as pd\n\n# 导入 Excel 文件\nfile_path = \"C:/Users/asus/Desktop/test/stata/prepare.xlsx\"\ndata = pd.read_excel(file_path, sheet_name=0)\n\n# 随机抽取10个样本数据\nsample_data = data.sample(n=10)\n\n# 打印样本数据\nprint(sample_data)\n\n      次数        出生日期 性别   年龄      医疗付费方式  国籍 新生儿出生体重 新生儿入院体重        出生地  \\\n650    1  1953-09-11  男  64岁    新型农村合作医疗  中国       －       －  福建省莆田市仙游县   \n591    1  1973-12-12  男  44岁    新型农村合作医疗  中国       －       －      福建莆田市   \n223    2  2010-08-06  男   7岁    新型农村合作医疗  中国       －       －  福建省莆田市荔城区   \n1390   1  1973-09-01  女  45岁    新型农村合作医疗  中国       －       －      福建莆田市   \n2161   1  1979-07-18  男  39岁  城镇居民基本医疗保险  中国       －       －  福建省莆田市秀屿区   \n1433   1  1950-06-07  女  68岁    新型农村合作医疗  中国       －       －      福建莆田市   \n1520   1  1980-04-08  男  38岁  城镇职工基本医疗保险  中国       －       －      福建莆田市   \n2043   1  1973-12-14  男  44岁  城镇居民基本医疗保险  中国       －       －        福建省   \n1681   1  1984-10-19  女  34岁         全自费  中国       －       －      福建仙游县   \n1229   1  1976-10-21  男  41岁  城镇居民基本医疗保险  中国       －       －     福建省莆田市   \n\n             籍贯  ... 麻醉开始时间3 麻醉结束时间3 麻醉方式3 麻醉分级3 切口部位3 切口等级3  NNIS分级3 手术部位感染3  \\\n650   福建省莆田市仙游县  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n591          莆田  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n223      福建省莆田市  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1390      福建莆田市  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n2161  福建省莆田市秀屿区  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1433       福建莆田  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1520       福建莆田  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n2043        福建省  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1681      福建仙游县  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1229     福建省莆田市  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n\n     术前住院天数3  手术持续时间3  \n650      NaN      NaN  \n591      NaN      NaN  \n223      NaN      NaN  \n1390     NaN      NaN  \n2161     NaN      NaN  \n1433     NaN      NaN  \n1520     NaN      NaN  \n2043     NaN      NaN  \n1681     NaN      NaN  \n1229     NaN      NaN  \n\n[10 rows x 202 columns]\n\n\n我们可以看到，该数据的列很多，第一张表中有220列，我们需要对其进行一些筛选。\n\n\n\n从哪里开始是一个需要思考的问题，对于数据的认识决定了你处理问题的方向和效率。首先，理解数据的来源至关重要，这包括了解数据是如何收集的、收集过程中可能出现的偏差或错误。其次，明确数据的类型与结构也是关键步骤之一，不同类型的数据（如定量数据、定性数据）需要采用不同的分析方法。再者，对数据进行初步探索，比如通过可视化手段观察数据分布特征，或是计算一些基本统计量来了解数据的基本情况，能够帮助你更好地制定数据处理策略。\n在真正开始处理数据之前，还需要考虑你的目标是什么。是为了回答一个具体的问题，还是为了探索潜在的模式？明确了目标之后，才能有针对性地选择合适的工具和技术。此外，考虑到数据质量的问题，数据清洗是不可跳过的一步，它包括去除异常值、填补缺失值等操作，这对于提高分析结果的准确性非常关键。\n最后，保持对数据伦理的关注同样重要，在整个数据分析的过程中，确保遵循相关的隐私保护法规和道德标准，这样才能确保你的工作不仅有效，而且负责任。通过对数据全面而深刻的理解，你可以更加自信地从数据中提取有价值的信息，并为决策提供有力支持。\n\n\n这份Excel文件有6张sheet，分别是2018-2023年，首先需要检查这六张sheet中的变量是否一致：\n\nimport pandas as pd\n\n# 导入 Excel 文件\nfile_path = \"C:/Users/asus/Desktop/test/stata/prepare.xlsx\"\nsheet_names = [\"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \"2023\"]\n\n# 读取所有 sheet 的数据\nsheets_data = {sheet: pd.read_excel(file_path, sheet_name=sheet) for sheet in sheet_names}\n\n# 获取每个 sheet 的列名\nsheets_columns = {sheet: set(data.columns) for sheet, data in sheets_data.items()}\n\n# 找出所有 sheet 的共同变量和不一致的变量\ncommon_columns = set.intersection(*sheets_columns.values())\nall_columns = set.union(*sheets_columns.values())\ninconsistent_columns = all_columns - common_columns\n\n# 打印结果\nprint(\"一致的变量名:\")\nprint(common_columns)\n\nprint(\"\\n不一致的变量名:\")\nprint(inconsistent_columns)\n\n# 打印每个 sheet 的变量\nfor sheet, columns in sheets_columns.items():\n    print(f\"\\n{sheet} 的变量: {columns}\")\n\n一致的变量名:\n{'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '术前使用预防性抗菌药物2', '3.4麻醉费', '是否有出院31天内再住院计划', '3级别', '1手术时间', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '1.2一般治疗操作费', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '总费用', '手术结束时间1', '1级别', '细菌名称3', '5愈合', '是否非计划重返手术室病例2', '4愈合', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '新生儿出生体重', '入院途径', '切口部位2', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '2愈合', '7.2中草药费', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1'}\n\n不一致的变量名:\n{'切口等级3', '7手术编码', '8手术名称', '麻醉开始时间3', '手术操作编码3', '切口部位3', '手术持续时间3', '麻醉分级3', '手术操作名称3', '7麻醉方式', '手术开始时间3', '手术部位感染3', '8级别', 'NNIS分级3', '4麻醉医师', '愈合2', '8麻醉方式', '手术结束时间3', '手术次数3', '7愈合', '7切口', '麻醉方式3', '7手术时间', '择期手术3', '7级别', '是否微创手术2', '麻醉结束时间3', '8手术时间', '8切口', '4麻醉方式', '7手术名称', '术前住院天数3', '8手术编码', '8愈合'}\n\n2018 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '手术部位感染3', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '愈合2', 'NNIS分级3', '2麻醉方式', '病理诊断', '3切口', '手术次数3', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '手术操作编码3', '切口部位3', '手术持续时间3', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '手术操作名称3', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '手术开始时间3', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '1.2一般治疗操作费', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '总费用', '手术结束时间1', '1级别', '细菌名称3', '5愈合', '是否非计划重返手术室病例2', '4愈合', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '麻醉分级3', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '麻醉方式3', '1.1一般医疗服务费', '6.1西药费', '是否微创手术2', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '切口等级3', '2愈合', '7.2中草药费', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '麻醉开始时间3', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '手术结束时间3', '药占比%', '婚姻', '入院诊断', '6手术编码', '择期手术2', '择期手术3', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '麻醉结束时间3', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '术前住院天数3', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1'}\n\n2019 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '愈合2', '2麻醉方式', '病理诊断', '3切口', '手术次数3', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '手术操作编码3', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '手术操作名称3', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '手术开始时间3', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '1.2一般治疗操作费', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '总费用', '手术结束时间1', '1级别', '细菌名称3', '5愈合', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '是否微创手术2', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '手术结束时间3', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1'}\n\n2020 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '8麻醉方式', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '8手术时间', '6麻醉方式', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n2021 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '4级别', '6级别', '8麻醉方式', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '8手术时间', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n2022 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '4级别', '6级别', '8麻醉方式', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '8手术时间', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n2023 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '4级别', '6级别', '8麻醉方式', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '8手术时间', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '4麻醉医师', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n\n然后剔除不一致的变量数据，同时创建一个新变量year，用sheet的年份对其进行填充，再按变量名对应合并6张表格的数据称为一张总表，命名为merge-sheet.xlsx输出到你需要存放数据的文件夹中。\n变量还是太多了，那接下来对变量进行筛选，首先我们可以对所有键值为空的变量进行剔除，或者根据实际的研究需要，剔除一部分键值全部为null的变量。\n这里我选择对键值全部为null或0的变量进行剔除。\n第一次尝试的时候，打开表后进行查看，发现变量顺序很乱，没有按照原始顺序进行排列，处理办法则是在前面的变量筛选部分使用DataFrame的loc方法选择列，同时保持列的顺序。\n同时为了节省时间，因为在Quarto中运行Python代码很慢，暂时还不知道原因，待以后调试一下。所以最后用一个程序解决上述这些问题，节省时间。\n\nimport pandas as pd\n\n# 导入 Excel 文件\nfile_path = \"C:/Users/asus/Desktop/test/stata/prepare.xlsx\"\noutput_path = \"C:/Users/asus/Desktop/test/stata/data/merge-data.xlsx\"\nfinal_output_path = \"C:/Users/asus/Desktop/test/stata/data/cleaned-merge-data.xlsx\"\nsheet_names = [\"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \"2023\"]\n\n# 读取所有 sheet 的数据\nsheets_data = {sheet: pd.read_excel(file_path, sheet_name=sheet) for sheet in sheet_names}\n\n# 获取每个 sheet 的列名\nsheets_columns = {sheet: set(data.columns) for sheet, data in sheets_data.items()}\n\n# 找出所有 sheet 的共同变量\ncommon_columns = set.intersection(*sheets_columns.values())\n# 保持原始顺序\ncommon_columns = list(common_columns)  \n\n# 剔除不一致的变量数据，并添加 year 变量\nfor sheet, data in sheets_data.items():\n    sheets_data[sheet] = data[list(common_columns)]\n    sheets_data[sheet]['year'] = sheet\n\n# 合并所有 sheet 的数据\nmerged_data = pd.concat(sheets_data.values(), ignore_index=True)\n\n# 输出合并后的数据到指定路径\nmerged_data.to_excel(output_path, index=False)\n\n# 重新导入合并后的数据\nmerged_data = pd.read_excel(output_path)\n\n# 剔除键值全部为 null 或 0 的变量，同时保持原始变量的顺序\nnon_null_columns = merged_data.dropna(axis=1, how='all').columns\nnon_zero_columns = merged_data.loc[:, (merged_data != 0).any(axis=0)].columns\nvalid_columns = [col for col in merged_data.columns if col in non_null_columns and col in non_zero_columns]\n\ncleaned_data = merged_data.loc[:, valid_columns]\n\n# 输出清理后的数据到指定路径\ncleaned_data.to_excel(final_output_path, index=False)\n\nprint(f\"清理后的数据已输出到 {final_output_path}\")\n\n# 展示部分数据\n\n# 随机抽取10个样本数据\nsample_data = cleaned_data.sample(n=10)\n\n# 打印样本数据\nprint(sample_data)\n\n清理后的数据已输出到 C:/Users/asus/Desktop/test/stata/data/cleaned-merge-data.xlsx\n       职业 麻醉方式1 NNIS分级1 6手术名称  1.3护理费  3.4麻醉费 是否有出院31天内再住院计划  3级别  \\\n6937   农民   NaN     NaN   NaN    46.0     0.0              无  NaN   \n39768  农民   静脉麻      0级   NaN   141.0   700.0              无  NaN   \n11560  务农   NaN     NaN   NaN    50.0     0.0              无  NaN   \n23707  退休   NaN     NaN   NaN   200.0     0.0              无  NaN   \n36596  农民   NaN     NaN   NaN   110.0     0.0              无  NaN   \n45595  农民    局麻      0级   NaN    50.0    35.0              无  NaN   \n48442  其他    全麻      0级   NaN   137.3   325.0              无  NaN   \n40626  农民   NaN     NaN   NaN   195.0   350.0              无  NaN   \n27519  工人   NaN     NaN   NaN   621.0   626.0              无  2.0   \n32953  农民   NaN     NaN   NaN   182.8   315.0              无  NaN   \n\n                     1手术时间 术前预防性抗菌药物给药时间1  ... 择期手术2  新生儿入院体重 清洁手术预防使用抗菌药物品种数  \\\n6937   2019-08-21 10:00:00            NaN  ...   NaN        －             NaN   \n39768  2023-01-16 10:04:00            NaN  ...   NaN        －             NaN   \n11560  2020-01-04 10:07:00            NaN  ...   NaN        －             NaN   \n23707                  NaN            NaN  ...   NaN        －             NaN   \n36596                  NaN            NaN  ...   NaN        －             NaN   \n45595  2023-09-21 18:21:00            NaN  ...     是        －             NaN   \n48442  2023-12-12 09:35:00            NaN  ...     是        －             NaN   \n40626                  NaN            NaN  ...   NaN        －             0.0   \n27519  2021-02-25 18:40:00            NaN  ...   NaN        －             NaN   \n32953  2022-02-14 00:00:00            NaN  ...   NaN        －             NaN   \n\n       级别2                                               出院诊断  1切口  \\\n6937   NaN  老年性白内障|H25.900|有,玻璃体混浊|H43.300|有,特指手术后状态|Z98.8...    Ⅰ   \n39768  NaN  背部脓肿|L02.201|有,高血压|I10.x00x002|有,完全性右束支传导阻滞|I4...    Ⅰ   \n11560  NaN  老年性白内障|H25.900|有,玻璃体混浊|H43.300|有,翼状胬肉|H11.000|...    Ⅰ   \n23707  NaN  移植肾功能不全|T86.102|有,蛋白尿|R80.x02|有,高血压|I10.x00x00...  NaN   \n36596  NaN                                     毒蛇咬伤|T63.001|有  NaN   \n45595  3.0  老年核性白内障|H25.100|有,玻璃体混浊|H43.300x001|有,2型糖尿病|E1...    Ⅰ   \n48442  2.0  多发性结肠息肉|K63.504|有,直肠息肉|K62.100|有,慢性结肠炎|K52.910...    0   \n40626  NaN  腹膜炎|K65.900|临床未确定,肠梗阻|K56.700|临床未确定,腹腔积液|R18.x...  NaN   \n27519  NaN  开放性指骨骨折|S62.611|有,手指开放性伤口不伴有指甲损害|S61.000|有,开放性...    Ⅲ   \n32953  NaN  多发性结肠息肉|K63.504|有,直肠息肉|K62.100|有,慢性结肠炎|K52.910...    Ⅱ   \n\n                     2手术时间 院内感染 切口等级1  year  \n6937                   NaN  NaN   NaN  2019  \n39768                  NaN  NaN     Ⅰ  2023  \n11560                  NaN  NaN   NaN  2020  \n23707                  NaN  NaN   NaN  2021  \n36596                  NaN  NaN   NaN  2022  \n45595  2023-09-21 18:21:00  NaN     Ⅰ  2023  \n48442  2023-12-12 09:35:00  NaN     0  2023  \n40626                  NaN  NaN   NaN  2023  \n27519  2021-02-25 18:40:00  NaN   NaN  2021  \n32953  2022-02-14 00:00:00  NaN   NaN  2022  \n\n[10 rows x 160 columns]",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "处理一份医疗数据"
    ]
  },
  {
    "objectID": "Guide/Python/2025-02-20-Medical-expenses.html#必须配置",
    "href": "Guide/Python/2025-02-20-Medical-expenses.html#必须配置",
    "title": "处理一份医疗数据",
    "section": "",
    "text": "运行此文档需要电脑上以安装Python，并且下列包已被安装并且能被调用：\njupyter-cache,pandas,openpuxl\n你可以使用 pip 或 conda 进行安装： pip install jupyter-cache",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "处理一份医疗数据"
    ]
  },
  {
    "objectID": "Guide/Python/2025-02-20-Medical-expenses.html#初步认识数据",
    "href": "Guide/Python/2025-02-20-Medical-expenses.html#初步认识数据",
    "title": "处理一份医疗数据",
    "section": "",
    "text": "我们可以使用pandas包来查看部分原始数据，数据的基本样式如下：\n\n# 安装并加载必要的包\nimport pandas as pd\n\n# 导入 Excel 文件\nfile_path = \"C:/Users/asus/Desktop/test/stata/prepare.xlsx\"\ndata = pd.read_excel(file_path, sheet_name=0)\n\n# 随机抽取10个样本数据\nsample_data = data.sample(n=10)\n\n# 打印样本数据\nprint(sample_data)\n\n      次数        出生日期 性别   年龄      医疗付费方式  国籍 新生儿出生体重 新生儿入院体重        出生地  \\\n650    1  1953-09-11  男  64岁    新型农村合作医疗  中国       －       －  福建省莆田市仙游县   \n591    1  1973-12-12  男  44岁    新型农村合作医疗  中国       －       －      福建莆田市   \n223    2  2010-08-06  男   7岁    新型农村合作医疗  中国       －       －  福建省莆田市荔城区   \n1390   1  1973-09-01  女  45岁    新型农村合作医疗  中国       －       －      福建莆田市   \n2161   1  1979-07-18  男  39岁  城镇居民基本医疗保险  中国       －       －  福建省莆田市秀屿区   \n1433   1  1950-06-07  女  68岁    新型农村合作医疗  中国       －       －      福建莆田市   \n1520   1  1980-04-08  男  38岁  城镇职工基本医疗保险  中国       －       －      福建莆田市   \n2043   1  1973-12-14  男  44岁  城镇居民基本医疗保险  中国       －       －        福建省   \n1681   1  1984-10-19  女  34岁         全自费  中国       －       －      福建仙游县   \n1229   1  1976-10-21  男  41岁  城镇居民基本医疗保险  中国       －       －     福建省莆田市   \n\n             籍贯  ... 麻醉开始时间3 麻醉结束时间3 麻醉方式3 麻醉分级3 切口部位3 切口等级3  NNIS分级3 手术部位感染3  \\\n650   福建省莆田市仙游县  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n591          莆田  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n223      福建省莆田市  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1390      福建莆田市  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n2161  福建省莆田市秀屿区  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1433       福建莆田  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1520       福建莆田  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n2043        福建省  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1681      福建仙游县  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n1229     福建省莆田市  ...     NaN     NaN   NaN   NaN   NaN   NaN      NaN     NaN   \n\n     术前住院天数3  手术持续时间3  \n650      NaN      NaN  \n591      NaN      NaN  \n223      NaN      NaN  \n1390     NaN      NaN  \n2161     NaN      NaN  \n1433     NaN      NaN  \n1520     NaN      NaN  \n2043     NaN      NaN  \n1681     NaN      NaN  \n1229     NaN      NaN  \n\n[10 rows x 202 columns]\n\n\n我们可以看到，该数据的列很多，第一张表中有220列，我们需要对其进行一些筛选。",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "处理一份医疗数据"
    ]
  },
  {
    "objectID": "Guide/Python/2025-02-20-Medical-expenses.html#对数据的思考",
    "href": "Guide/Python/2025-02-20-Medical-expenses.html#对数据的思考",
    "title": "处理一份医疗数据",
    "section": "",
    "text": "从哪里开始是一个需要思考的问题，对于数据的认识决定了你处理问题的方向和效率。首先，理解数据的来源至关重要，这包括了解数据是如何收集的、收集过程中可能出现的偏差或错误。其次，明确数据的类型与结构也是关键步骤之一，不同类型的数据（如定量数据、定性数据）需要采用不同的分析方法。再者，对数据进行初步探索，比如通过可视化手段观察数据分布特征，或是计算一些基本统计量来了解数据的基本情况，能够帮助你更好地制定数据处理策略。\n在真正开始处理数据之前，还需要考虑你的目标是什么。是为了回答一个具体的问题，还是为了探索潜在的模式？明确了目标之后，才能有针对性地选择合适的工具和技术。此外，考虑到数据质量的问题，数据清洗是不可跳过的一步，它包括去除异常值、填补缺失值等操作，这对于提高分析结果的准确性非常关键。\n最后，保持对数据伦理的关注同样重要，在整个数据分析的过程中，确保遵循相关的隐私保护法规和道德标准，这样才能确保你的工作不仅有效，而且负责任。通过对数据全面而深刻的理解，你可以更加自信地从数据中提取有价值的信息，并为决策提供有力支持。\n\n\n这份Excel文件有6张sheet，分别是2018-2023年，首先需要检查这六张sheet中的变量是否一致：\n\nimport pandas as pd\n\n# 导入 Excel 文件\nfile_path = \"C:/Users/asus/Desktop/test/stata/prepare.xlsx\"\nsheet_names = [\"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \"2023\"]\n\n# 读取所有 sheet 的数据\nsheets_data = {sheet: pd.read_excel(file_path, sheet_name=sheet) for sheet in sheet_names}\n\n# 获取每个 sheet 的列名\nsheets_columns = {sheet: set(data.columns) for sheet, data in sheets_data.items()}\n\n# 找出所有 sheet 的共同变量和不一致的变量\ncommon_columns = set.intersection(*sheets_columns.values())\nall_columns = set.union(*sheets_columns.values())\ninconsistent_columns = all_columns - common_columns\n\n# 打印结果\nprint(\"一致的变量名:\")\nprint(common_columns)\n\nprint(\"\\n不一致的变量名:\")\nprint(inconsistent_columns)\n\n# 打印每个 sheet 的变量\nfor sheet, columns in sheets_columns.items():\n    print(f\"\\n{sheet} 的变量: {columns}\")\n\n一致的变量名:\n{'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '术前使用预防性抗菌药物2', '3.4麻醉费', '是否有出院31天内再住院计划', '3级别', '1手术时间', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '1.2一般治疗操作费', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '总费用', '手术结束时间1', '1级别', '细菌名称3', '5愈合', '是否非计划重返手术室病例2', '4愈合', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '新生儿出生体重', '入院途径', '切口部位2', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '2愈合', '7.2中草药费', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1'}\n\n不一致的变量名:\n{'切口等级3', '7手术编码', '8手术名称', '麻醉开始时间3', '手术操作编码3', '切口部位3', '手术持续时间3', '麻醉分级3', '手术操作名称3', '7麻醉方式', '手术开始时间3', '手术部位感染3', '8级别', 'NNIS分级3', '4麻醉医师', '愈合2', '8麻醉方式', '手术结束时间3', '手术次数3', '7愈合', '7切口', '麻醉方式3', '7手术时间', '择期手术3', '7级别', '是否微创手术2', '麻醉结束时间3', '8手术时间', '8切口', '4麻醉方式', '7手术名称', '术前住院天数3', '8手术编码', '8愈合'}\n\n2018 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '手术部位感染3', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '愈合2', 'NNIS分级3', '2麻醉方式', '病理诊断', '3切口', '手术次数3', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '手术操作编码3', '切口部位3', '手术持续时间3', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '手术操作名称3', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '手术开始时间3', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '1.2一般治疗操作费', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '总费用', '手术结束时间1', '1级别', '细菌名称3', '5愈合', '是否非计划重返手术室病例2', '4愈合', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '麻醉分级3', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '麻醉方式3', '1.1一般医疗服务费', '6.1西药费', '是否微创手术2', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '切口等级3', '2愈合', '7.2中草药费', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '麻醉开始时间3', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '手术结束时间3', '药占比%', '婚姻', '入院诊断', '6手术编码', '择期手术2', '择期手术3', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '麻醉结束时间3', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '术前住院天数3', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1'}\n\n2019 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '愈合2', '2麻醉方式', '病理诊断', '3切口', '手术次数3', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '手术操作编码3', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '手术操作名称3', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '手术开始时间3', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '1.2一般治疗操作费', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '总费用', '手术结束时间1', '1级别', '细菌名称3', '5愈合', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '是否微创手术2', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '手术结束时间3', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1'}\n\n2020 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '8麻醉方式', '4级别', '6级别', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '8手术时间', '6麻醉方式', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n2021 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '4级别', '6级别', '8麻醉方式', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '8手术时间', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n2022 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '4级别', '6级别', '8麻醉方式', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '8手术时间', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '4麻醉方式', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n2023 的变量: {'职业', '麻醉方式1', 'NNIS分级1', '6手术名称', '1.3护理费', '1.4其他费用', '3.4麻醉费', '3级别', '1手术时间', '是否有出院31天内再住院计划', '术前使用预防性抗菌药物2', '术前预防性抗菌药物给药时间1', '1手术名称', '2.3影像学诊断费', '病室', '4切口', '2.4临床诊断项目费', '5手术编码', '入院前颅脑损伤昏迷时间', '愈合1', '5手术名称', '麻醉开始时间1', '8.4凝血因子类制品费', '手术操作名称2', '3手术名称', '次数', '国籍', '3手术编码', '8.1血费', '是否临床路径', '手术次数1', '2麻醉方式', '病理诊断', '3切口', '5切口', '是否药物过敏', '6手术时间', '患者入住重症监护室（ICU）情况', '细菌名称1', '药物过敏', '是否非计划重返手术室病例1', '术前住院天数2', '3手术时间', '病室.1', '民族', '1麻醉方式', '切口部位1', '医疗付费方式', '4手术编码', '出院科别', '是否有使用抗菌药物2', '2手术名称', '清洁手术预防使用抗菌药物总天数', '2切口', '4手术名称', '2手术编码', '是否在术后使用预防性抗菌药物1', '5麻醉方式', '出院日期', '切口等级2', '3麻醉方式', '9.3手术用一次性医用材料费', '术前预防性抗菌药物给药时间2', '是否在术后使用预防性抗菌药物2', '级别1', '手术部位感染1', '断脐后预防性使用抗菌药物给药时间2', 'RH', '感染情况', '是否有使用抗菌药物1', '断脐后预防性使用抗菌药物给药时间1', '8级别', '1.2一般治疗操作费', '4级别', '6级别', '8麻醉方式', '8.5细胞因子类制品费', '手术开始时间1', '入院科别', '总药品费', '6愈合', '血型', '3.5手术费', '7手术时间', '手术预防性使用抗菌药物天数1', '自付金额', '4手术时间', '6麻醉方式', '8手术时间', '8切口', '1级别', '总费用', '细菌名称3', '5愈合', '手术结束时间1', '是否非计划重返手术室病例2', '4愈合', '7手术名称', '手术次数2', '是否微创手术1', '7.1中成药费', '预防性抗菌药物使用时机1', '3愈合', '腔镜手术名称1', '10.其他费', '手术操作名称1', '麻醉方式2', '2级别', '6.2抗菌药物费用', '出生地', '入院日期', '1愈合', '4.康复费', '输血反应', '输血反应次数', '抗菌药物使用天数', '本次住院期间有无重返手术室的计划1', '目的', '预防性抗菌药物使用时机2', '死亡患者尸检', '术前使用预防性抗菌药物1', '7麻醉方式', '手术开始时间2', '性别', '病案质量', '6切口', '择期手术1', '麻醉开始时间2', '籍贯', '1手术编码', '4麻醉医师', '9.1检查用一次性医用材料费', 'NNIS分级2', '3.1非手术治疗项目费', '住院天数', '手术操作编码1', '手术预防性使用抗菌药物天数2', '入院后颅脑损伤昏迷时间', '1.1一般医疗服务费', '7级别', '6.1西药费', '麻醉结束时间1', '细菌名称4', '血管介入治疗', '新生儿出生体重', '入院途径', '切口部位2', '8愈合', '8.3球蛋白类制品费', '血管介入治疗抗菌药物使用天数', '手术持续时间1', '年龄', '7手术编码', '2愈合', '7.2中草药费', '8手术名称', '2.2实验室诊断费', '手术结束时间2', '术后预防性抗菌药物结束时间2', '麻醉分级2', '3.2临床物理治疗费', '出生日期', '5手术时间', '手术操作编码2', '术前住院天数1', '2.1病理诊断费', '3.3手术治疗费', '细菌名称2', '腔镜手术名称2', '本次住院期间有无重返手术室的计划2', '8.2白蛋白类制品费', '麻醉结束时间2', '输液反应次数', '手术部位感染2', '手术持续时间2', '5级别', '术后预防性抗菌药物结束时间1', '输液反应', '麻醉分级1', '离院方式', '药占比%', '婚姻', '入院诊断', '7愈合', '7切口', '6手术编码', '择期手术2', '新生儿入院体重', '清洁手术预防使用抗菌药物品种数', '级别2', '5.中医治疗费', '出院诊断', '1切口', '2手术时间', '9.2治疗用一次性医用材料费', '院内感染', '切口等级1', '8手术编码'}\n\n\n然后剔除不一致的变量数据，同时创建一个新变量year，用sheet的年份对其进行填充，再按变量名对应合并6张表格的数据称为一张总表，命名为merge-sheet.xlsx输出到你需要存放数据的文件夹中。\n变量还是太多了，那接下来对变量进行筛选，首先我们可以对所有键值为空的变量进行剔除，或者根据实际的研究需要，剔除一部分键值全部为null的变量。\n这里我选择对键值全部为null或0的变量进行剔除。\n第一次尝试的时候，打开表后进行查看，发现变量顺序很乱，没有按照原始顺序进行排列，处理办法则是在前面的变量筛选部分使用DataFrame的loc方法选择列，同时保持列的顺序。\n同时为了节省时间，因为在Quarto中运行Python代码很慢，暂时还不知道原因，待以后调试一下。所以最后用一个程序解决上述这些问题，节省时间。\n\nimport pandas as pd\n\n# 导入 Excel 文件\nfile_path = \"C:/Users/asus/Desktop/test/stata/prepare.xlsx\"\noutput_path = \"C:/Users/asus/Desktop/test/stata/data/merge-data.xlsx\"\nfinal_output_path = \"C:/Users/asus/Desktop/test/stata/data/cleaned-merge-data.xlsx\"\nsheet_names = [\"2018\", \"2019\", \"2020\", \"2021\", \"2022\", \"2023\"]\n\n# 读取所有 sheet 的数据\nsheets_data = {sheet: pd.read_excel(file_path, sheet_name=sheet) for sheet in sheet_names}\n\n# 获取每个 sheet 的列名\nsheets_columns = {sheet: set(data.columns) for sheet, data in sheets_data.items()}\n\n# 找出所有 sheet 的共同变量\ncommon_columns = set.intersection(*sheets_columns.values())\n# 保持原始顺序\ncommon_columns = list(common_columns)  \n\n# 剔除不一致的变量数据，并添加 year 变量\nfor sheet, data in sheets_data.items():\n    sheets_data[sheet] = data[list(common_columns)]\n    sheets_data[sheet]['year'] = sheet\n\n# 合并所有 sheet 的数据\nmerged_data = pd.concat(sheets_data.values(), ignore_index=True)\n\n# 输出合并后的数据到指定路径\nmerged_data.to_excel(output_path, index=False)\n\n# 重新导入合并后的数据\nmerged_data = pd.read_excel(output_path)\n\n# 剔除键值全部为 null 或 0 的变量，同时保持原始变量的顺序\nnon_null_columns = merged_data.dropna(axis=1, how='all').columns\nnon_zero_columns = merged_data.loc[:, (merged_data != 0).any(axis=0)].columns\nvalid_columns = [col for col in merged_data.columns if col in non_null_columns and col in non_zero_columns]\n\ncleaned_data = merged_data.loc[:, valid_columns]\n\n# 输出清理后的数据到指定路径\ncleaned_data.to_excel(final_output_path, index=False)\n\nprint(f\"清理后的数据已输出到 {final_output_path}\")\n\n# 展示部分数据\n\n# 随机抽取10个样本数据\nsample_data = cleaned_data.sample(n=10)\n\n# 打印样本数据\nprint(sample_data)\n\n清理后的数据已输出到 C:/Users/asus/Desktop/test/stata/data/cleaned-merge-data.xlsx\n       职业 麻醉方式1 NNIS分级1 6手术名称  1.3护理费  3.4麻醉费 是否有出院31天内再住院计划  3级别  \\\n6937   农民   NaN     NaN   NaN    46.0     0.0              无  NaN   \n39768  农民   静脉麻      0级   NaN   141.0   700.0              无  NaN   \n11560  务农   NaN     NaN   NaN    50.0     0.0              无  NaN   \n23707  退休   NaN     NaN   NaN   200.0     0.0              无  NaN   \n36596  农民   NaN     NaN   NaN   110.0     0.0              无  NaN   \n45595  农民    局麻      0级   NaN    50.0    35.0              无  NaN   \n48442  其他    全麻      0级   NaN   137.3   325.0              无  NaN   \n40626  农民   NaN     NaN   NaN   195.0   350.0              无  NaN   \n27519  工人   NaN     NaN   NaN   621.0   626.0              无  2.0   \n32953  农民   NaN     NaN   NaN   182.8   315.0              无  NaN   \n\n                     1手术时间 术前预防性抗菌药物给药时间1  ... 择期手术2  新生儿入院体重 清洁手术预防使用抗菌药物品种数  \\\n6937   2019-08-21 10:00:00            NaN  ...   NaN        －             NaN   \n39768  2023-01-16 10:04:00            NaN  ...   NaN        －             NaN   \n11560  2020-01-04 10:07:00            NaN  ...   NaN        －             NaN   \n23707                  NaN            NaN  ...   NaN        －             NaN   \n36596                  NaN            NaN  ...   NaN        －             NaN   \n45595  2023-09-21 18:21:00            NaN  ...     是        －             NaN   \n48442  2023-12-12 09:35:00            NaN  ...     是        －             NaN   \n40626                  NaN            NaN  ...   NaN        －             0.0   \n27519  2021-02-25 18:40:00            NaN  ...   NaN        －             NaN   \n32953  2022-02-14 00:00:00            NaN  ...   NaN        －             NaN   \n\n       级别2                                               出院诊断  1切口  \\\n6937   NaN  老年性白内障|H25.900|有,玻璃体混浊|H43.300|有,特指手术后状态|Z98.8...    Ⅰ   \n39768  NaN  背部脓肿|L02.201|有,高血压|I10.x00x002|有,完全性右束支传导阻滞|I4...    Ⅰ   \n11560  NaN  老年性白内障|H25.900|有,玻璃体混浊|H43.300|有,翼状胬肉|H11.000|...    Ⅰ   \n23707  NaN  移植肾功能不全|T86.102|有,蛋白尿|R80.x02|有,高血压|I10.x00x00...  NaN   \n36596  NaN                                     毒蛇咬伤|T63.001|有  NaN   \n45595  3.0  老年核性白内障|H25.100|有,玻璃体混浊|H43.300x001|有,2型糖尿病|E1...    Ⅰ   \n48442  2.0  多发性结肠息肉|K63.504|有,直肠息肉|K62.100|有,慢性结肠炎|K52.910...    0   \n40626  NaN  腹膜炎|K65.900|临床未确定,肠梗阻|K56.700|临床未确定,腹腔积液|R18.x...  NaN   \n27519  NaN  开放性指骨骨折|S62.611|有,手指开放性伤口不伴有指甲损害|S61.000|有,开放性...    Ⅲ   \n32953  NaN  多发性结肠息肉|K63.504|有,直肠息肉|K62.100|有,慢性结肠炎|K52.910...    Ⅱ   \n\n                     2手术时间 院内感染 切口等级1  year  \n6937                   NaN  NaN   NaN  2019  \n39768                  NaN  NaN     Ⅰ  2023  \n11560                  NaN  NaN   NaN  2020  \n23707                  NaN  NaN   NaN  2021  \n36596                  NaN  NaN   NaN  2022  \n45595  2023-09-21 18:21:00  NaN     Ⅰ  2023  \n48442  2023-12-12 09:35:00  NaN     0  2023  \n40626                  NaN  NaN   NaN  2023  \n27519  2021-02-25 18:40:00  NaN   NaN  2021  \n32953  2022-02-14 00:00:00  NaN   NaN  2022  \n\n[10 rows x 160 columns]",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "处理一份医疗数据"
    ]
  },
  {
    "objectID": "Guide/R/2025-02-22-CLHLS.html",
    "href": "Guide/R/2025-02-22-CLHLS.html",
    "title": "CLHLS Data Analysis by R",
    "section": "",
    "text": "这是一个使用 R 语言对 CLHLS 数据进行清洗和分析的工作文档。\n\n本文数据源来自北大开放研究数据平台。DVN/WBO7LK_2020\n使用SAS逐渐让我失去的耐心，极其臃肿和笨重，Vintage Car，交互页面也很糟糕，用起来很令人烦躁，遂改用R对数据进行分析。",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "R introduction",
      "CLHLS Data Analysis by R"
    ]
  },
  {
    "objectID": "Guide/R/2025-02-22-CLHLS.html#加载必要的包",
    "href": "Guide/R/2025-02-22-CLHLS.html#加载必要的包",
    "title": "CLHLS Data Analysis by R",
    "section": "",
    "text": "本文数据源来自北大开放研究数据平台。DVN/WBO7LK_2020\n使用SAS逐渐让我失去的耐心，极其臃肿和笨重，Vintage Car，交互页面也很糟糕，用起来很令人烦躁，遂改用R对数据进行分析。",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "R introduction",
      "CLHLS Data Analysis by R"
    ]
  },
  {
    "objectID": "Guide/R/2025-02-22-CLHLS.html#数据导出",
    "href": "Guide/R/2025-02-22-CLHLS.html#数据导出",
    "title": "CLHLS Data Analysis by R",
    "section": "\n2.1 数据导出",
    "text": "2.1 数据导出\n\n# 导出筛选后的数据到 Excel\nwrite_xlsx(selected_data, \"C:/Users/asus/Desktop/test/CLHLS/CLHLS数据/CLHLS数据/clhls_2018_sort0220.xlsx\")",
    "crumbs": [
      "Home",
      "统计软件使用指南",
      "R introduction",
      "CLHLS Data Analysis by R"
    ]
  },
  {
    "objectID": "Guide/SAS/2025-02-16-CLHLS.html",
    "href": "Guide/SAS/2025-02-16-CLHLS.html",
    "title": "使用SAS处理CLHLS数据",
    "section": "",
    "text": "“中国老年健康影响因素跟踪调查”（简称“中国老年健康调查”，英文缩写CLHLS），以下简称CLHLS数据，是由北京大学健康老龄与发展研究中心/国家发展研究院组织的老年人追踪调查，调查范围覆盖全国23个省市自治区，调查对象为65岁及以上老年人和35-64岁成年子女，调查问卷分为存活被访者问卷和死亡老人家属问卷两种。存活被访者问卷的调查内容包括老人及家庭基本状况、社会经济背景及家庭结构、经济来源和经济状况、健康和生活质量自评、认知功能、性格心理特征、日常活动能力、生活方式、生活照料、疾病治疗和医疗费承担；死亡老人家属问卷的调查内容包括老人死亡时间、死因等内容。该调查项目在1998年进行基线调查后分别于2000 年、2002年、2005年、2008-2009年、2011-2012年、2014年和2017-2018年进行了跟踪调查，最近的一次跟踪调查(2017-2018年)共访问15,874 名65+岁老年人,收集了2014-2018年期间死亡的2,226位老年人的信息。“中国老年健康调查”累计入户访问11.3万人次，其中最需照料的80岁及以上高龄老人占总样本67.4%，其余为较低龄老人和中年对照组；同时访问2.89万位65+岁已死亡被访老人的直接家庭成员，收集了老人死亡前健康状况、生活质量与医疗和照料需求成本等详细数据。CLHLS数据共有15874例样本，761个变量，由于本文主要研究老年人的自评和客观健康水平以及代际支持模式对健康水平的影响，因此需要对样本和变量进行筛选，保留符合要求的样本和变量进行后续的分析。DVN/WBO7LK_2020"
  },
  {
    "objectID": "Guide/SAS/2025-02-16-CLHLS.html#因变量的选取",
    "href": "Guide/SAS/2025-02-16-CLHLS.html#因变量的选取",
    "title": "使用SAS处理CLHLS数据",
    "section": "因变量的选取",
    "text": "因变量的选取\n老年人自评健康状况（SHEALTH）：对应变量 b12 （self-reported health），为有序变量（Ordinal），可用于衡量老年人对自身健康的主观评价，其赋值为：很好=1，好=2，一般=3，不好=4，很不好=5。\n生活自理能力（ADL）：对应变量 e1 （bathing，洗澡）、e2 （dressing，穿衣）、e3 （toileting，如厕）、e4 （indoor transferring，室内移动）、e5 （continence，大小便控制）、e6 （feeding，进食），均为有序变量（Ordinal）。通过这些变量的得分计算可体现老年人的生活自理能力。\n变量 e1b 、e2b 、e3b 、e4b 、e5b 、e6b 分别记录了在需要他人帮助情况下，这些活动的帮助持续天数，可作为辅助信息进一步分析生活自理能力情况。其变量赋值为：不需要帮扶=1，需要一个帮扶=2，需要多个帮扶=3，将其合并为ADL变量，相加值越低则表示生活自理能力越好，反之越差。\n工具型生活自理能力（IADL）：对应变量 e7 （able to go outside to visit neighbors，能外出拜访邻居）、e8 （able to go shopping by yourself，能自己去购物）、e9 （able to make food by yourself，能自己做饭）、e10 （able to wash clothes，能洗衣服）、e11 （able to walk one kilometer，能步行一公里）、e12 （able to carry 5kg weight，能搬运 5 公斤重物）、e13 （able to crouch and stand three times，能蹲下并站立三次）、e14 （able to take public transportation，能乘坐公共交通工具），均为有序变量（Ordinal）。这些变量可综合反映老年人在更复杂日常生活任务上的能力。其变量赋值为：可以=1，些微困难=2，不能=3，将其合并为IADL变量，相加值越低则表示工具型生活自理能力越好，反之越差。"
  },
  {
    "objectID": "Guide/SAS/2025-02-16-CLHLS.html#自变量的选取",
    "href": "Guide/SAS/2025-02-16-CLHLS.html#自变量的选取",
    "title": "使用SAS处理CLHLS数据",
    "section": "自变量的选取",
    "text": "自变量的选取\n经济支持：新设变量为 economic-support，对应的原始变量 f12a （how much did you receive from your son (s) or daughter (s)-in-law last year，去年从儿子或儿媳处收到多少钱）、f12b （how much did you receive from your daughter (s) or son (s)-in-law last year，去年从女儿或女婿处收到多少钱）、f12c （how much did you receive from your grandchild (ren) last year，去年从孙辈处收到多少钱），均为尺度变量（Scale），其中给与物质支持=99998，不知道=88888，缺失=99999，通过统计99998的个数来估计经济支持的程度，如果没有99998则赋值为0,。通过这些变量可衡量子女及孙辈在物质上给予老年人的经济支持。\n照料支持：新设变量为：residence，对应原始变量a51（co-residence of interviewee，受访者居住情况），有人同住=1，独居=2，住在机构=3；新设变量为living，对应变量 a52（how many people are living with you，有多少人居住在一起），数值型变量；新设变量 visit-fren，对应细分变量为f103a5 （frequent visits of the 1st child，第一个孩子的探访频率）、f103b5 （frequent visits of the 2nd child，第二个孩子的探访频率）、f103c5 （frequent visits of the 3rd child，第三个孩子的探访频率）等（一直到 f103k5 等关于各个孩子的探访频率变量），均为有序变量（Ordinal），有探访=1，没有=2，任一一个孩子=1即可认为有探访，同时给新变量赋值为1，如果没有则给新变量赋值为0。\n设置care-support变量，如果residence=1或visit-fren=1则给care-support赋值为1，否则赋值为0。\n用这些变量以老年人与子女相处和见面的频率来间接反映子女对老人的照料支持情况。\n情感支持（emotion support）：对应细分变量 f103a6 （contact with the 1st child，与第一个孩子的联系情况）、f103b6 （contact with the 2nd child，与第二个孩子的联系情况）、f103c6 （contact with the 3rd child，与第三个孩子的联系情况）等（一直到 f103k6 等关于各个孩子的联系情况变量），均为名义变量（Nominal）。根据这些变量所反映的与子女联系的情况来体现子女对老人的情感关怀。有联系=1，没联系=2，任一一个为1即可说明有孩子联系。"
  },
  {
    "objectID": "Guide/SAS/2025-02-16-CLHLS.html#控制变量的选取",
    "href": "Guide/SAS/2025-02-16-CLHLS.html#控制变量的选取",
    "title": "使用SAS处理CLHLS数据",
    "section": "控制变量的选取",
    "text": "控制变量的选取\n年龄：问卷中的 trueage “真实年龄”，用于获取老年人的实际年龄。\n性别：问卷中 a1 “性别”，男性赋值为 1，女性赋值为 2。\n受教育程度：问卷中的 f1 “受教育年限”，数值型变量，但是其中如果赋值为88或99则表示“不知道”或“缺失”。\n退休前的工作类型：问卷中 f2 “60 岁之前的主要职业”，名义变量，专业技术人员=0，政府、机构或管理人员=1，商业、服务或工业工人=2，自雇人士=3，农、林、牧或渔业工人=4，家政工人=5，军事人员=6，从未工作过=7，其他=8。\n婚姻状况：问卷中 f41 “您目前的婚姻状态是？”，将 “已婚或与伴侣同居” 赋值为 1，其他赋值为 0。\n户口类型：问卷中的 hukou “hukou type of the elderly being visited，被访老人的户口类型”， “城镇” 赋值为 1，“农村” 赋值为 2。\n社保和养老保险：问卷中的 nf64a f64b f64c（do you have any social security and social insurance now? 你是否有任何社保和社会保险？），有任何一种社保或养老保险则赋值为 1，没有赋值为 0；。\n医疗保险：问卷中f64d f64e f64f f64h(是否有医疗保险)，有任何一种医疗保险则赋值为 1，没有赋值为 0。\n子女年龄：通过对问卷中的 f103a4 f103b4 到 f103m4 来检查该老人的子女的年龄，如果最后一个还活着的孩子年龄&gt;60，赋值为1，则表示该老人的子女也是老年状态，否则为0。\n慢性病：问卷中 g15a1 g15b1 一直到 g15x1 表示是否患有某种慢性病，有任何一种慢性病赋值为 1，否则为 0。\n抽烟：问卷中 g151 “你24小时内抽烟吗？”，是赋值为 1，否赋值为 2。\n喝酒：问卷中 g161 “你24小时内饮酒吗？”，是赋值为 1，否赋值为 2。\n体育锻炼：问卷中d91 d92 分别表示“目前是否锻炼？”和“过去是否锻炼过？”，是赋值为 1，否赋值为 2。"
  },
  {
    "objectID": "Guide/SAS/2025-02-16-CLHLS.html#纳入标准",
    "href": "Guide/SAS/2025-02-16-CLHLS.html#纳入标准",
    "title": "使用SAS处理CLHLS数据",
    "section": "纳入标准",
    "text": "纳入标准\n年龄要求：年龄大于 60 岁，通过实际年龄 &gt; 60进行筛选。60 岁以上人群处于老年阶段，其健康、社会角色和代际关系有老年群体特征，符合本研究对老年人的研究范围。\n生育情况：生育过子女，通过反映生育子女数量的变量（如 f10 生育子女数），要求f10 &gt; 0。代际支持模式研究需存在代际关系，生育子女是形成代际关系的前提。\n子女存活情况：所生育子女中至少有一个存活。可通过检查如 f103a3 - f103m3 等表示孩子存活情况的变量，只要有一个值为表示存活的标识即可纳入（原始数据的变量赋值为存活=1，去世=2）。有在世子女才能开展代际支持研究。"
  },
  {
    "objectID": "Guide/SAS/2025-02-16-CLHLS.html#排除标准",
    "href": "Guide/SAS/2025-02-16-CLHLS.html#排除标准",
    "title": "使用SAS处理CLHLS数据",
    "section": "排除标准",
    "text": "排除标准\n关键变量缺失值：排除关键变量存在缺失值和无效值的样本。关键变量涵盖上述控制变量及后续分析的因变量、自变量等。缺失值或无效值会影响数据质量和分析结果准确性。\n不合理生育数量：生育子女数量超过合理上限（结合研究背景和数据确定，上限为 7）或者为缺失值，则需要排除（f10&gt;7 or f10 = null）。不合理生育数量可能是数据录入错误或特殊情况，干扰研究结果。\n通过多次尝试，以下是用于筛选的SAS代码：\n/* 导入必要的库 */\nproc import \n    datafile = 'C:\\Users\\asus\\Desktop\\test\\CLHLS\\Analysis-0214\\clhls_2018_15874.sav'  /* 请将这里替换为你的SAV文件的实际路径 */\n    out = raw_data \n    dbms = sav \n    replace;\nrun;\n\n/* 筛选合适的变量并排序 */\ndata selected_data;\n    set raw_data;\n    \n    /* 因变量 */\n    /* 老年人自评健康状况（SHEALTH） */\n    SHEALTH = b12;\n    \n    /* 生活自理能力（ADL） */\n    array adl_vars(*) e1 e2 e3 e4 e5 e6;\n    array adl_help_days(*) e1b e2b e3b e4b e5b e6b;\n    ADL = 0;\n    do i = 1 to dim(adl_vars);\n        if adl_help_days[i] = 1 then ADL = ADL + adl_vars[i];\n        else if adl_help_days[i] = 2 then ADL = ADL + adl_vars[i] * 2;\n        else if adl_help_days[i] = 3 then ADL = ADL + adl_vars[i] * 3;\n    end;\n    \n    /* 新增：生活自理障碍二分类变量 ADL2 */\n    ADL2 = 0;\n    do i = 1 to dim(adl_vars);\n        if adl_vars[i] &gt; 1 then do;\n            ADL2 = 1;\n            leave;\n        end;\n    end;\n    \n    /* 工具型生活自理能力（IADL） */\n    array iadl_vars(*) e7 e8 e9 e10 e11 e12 e13 e14;\n    IADL = 0;\n    do i = 1 to dim(iadl_vars);\n        IADL = IADL + iadl_vars[i];\n    end;\n    \n    /* 新增：工具型生活自理障碍二分类变量 IADL2 */\n    IADL2 = 0;\n    do i = 1 to dim(iadl_vars);\n        if iadl_vars[i] &gt; 1 then do;\n            IADL2 = 1;\n            leave;\n        end;\n    end;\n    \n    /* 自变量 */\n    /* 经济支持 */\n    array economic_vars(*) f12a f12b f12c;\n    economic_support = 0;\n    do i = 1 to dim(economic_vars);\n        if economic_vars[i] = 99998 then\n            economic_support = economic_support + 10000;\n        else if economic_vars[i] in (88888, 99999) then\n            continue; /* 跳过无效值或缺失值 */\n        else\n            economic_support = economic_support + economic_vars[i];\n    end;\n    \n    /* 照料支持 */\n    residence = a51;\n    living = a52;\n    array visit_freq(*) f103a5 f103b5 f103c5 f103d5 f103e5 f103f5 f103g5 f103h5 f103i5 f103j5 f103k5;\n    visit_fren = 0;\n    do i = 1 to dim(visit_freq);\n        if visit_freq[i] = 1 then do;\n            visit_fren = 1;\n            leave;\n        end;\n    end;\n    \n    /* 情感支持 */\n    array contact_vars(*) f103a6 f103b6 f103c6 f103d6 f103e6 f103f6 f103g6 f103h6 f103i6 f103j6 f103k6;\n    emotion_support = 2; /* 先假设没联系 */\n    do i = 1 to dim(contact_vars);\n        if contact_vars[i] = 1 then do;\n            emotion_support = 1;\n            leave;\n        end;\n    end;\n    \n    /* 控制变量 */\n    /* 年龄 */\n    age = trueage;\n    \n    /* 性别 */\n    gender = a1;\n    \n    /* 受教育程度 */\n    education = f1;\n    \n    /* 退休前的工作类型 */\n    job_type = f2;\n    \n    /* 婚姻状况 */\n    if f41 = 1 then marriage_status = 1; /* 假设 1 代表已婚或与伴侣同居 */\n    else marriage_status = 0;\n    \n    /* 户口类型 */\n    hukou_type = hukou;\n    \n    /* 社保和养老保险 */\n    if nf64a = 0 or f64b = 1 or f64c = 1 or f64i = 1 then social_insurance = 1;\n    else social_insurance = 0;\n    \n    /* 医疗保险 */\n    if f64d = 1 or f64e = 1 or f64g = 1 or f64h = 1 then medical_insurance = 1;\n    else medical_insurance = 0;\n    \n    /* 慢性病 */\n    array chronic_vars(*) g15a1 g15b1 g15c1 g15d1 g15e1 g15f1 g15g1 g15h1 g15i1 g15j1 g15k1 g15l1 g15m1 g15n1 g15o1 g15p1 g15q1 g15r1 g15s1 g15t1 g15u1 g15v1 g15w1 g15x1;\n    chronic_disease = 0;\n    do i = 1 to dim(chronic_vars);\n        if chronic_vars[i] = 1 then chronic_disease = 1;\n        if chronic_disease = 1 then leave;\n    end;\n    \n    /* 抽烟 */\n    smoking = g151;\n    \n    /* 喝酒 */\n    drinking = g161;\n    \n    /* 体育锻炼 */\n    if d91 = 1 or d92 = 1 then exercise = 1;\n    else exercise = 2;\n\n    /* 子女年龄状态 */\n    array child_ages(*) f103a4 f103b4 f103c4 f103d4 f103e4 f103f4 f103g4 f103h4 f103i4 f103j4 f103k4 f103l4 f103m4;\n    array child_alive(*) f103a3 f103b3 f103c3 f103d3 f103e3 f103f3 f103g3 f103h3 f103i3 f103j3 f103k3 f103l3 f103m3;\n    last_alive_child_age = .;\n    do i = dim(child_ages) to 1 by -1;\n        if child_alive[i] = 1 then do;\n            last_alive_child_age = child_ages[i];\n            leave;\n        end;\n    end;\n    if last_alive_child_age &gt; 60 then child_elderly_status = 1;\n    else child_elderly_status = 0;\n\n    /* 生成 care - support 变量 */\n    if residence = 1 or visit_fren = 1 then care_support = 1;\n    else care_support = 0;\n    \n    /* 选择需要的变量 */\n    keep SHEALTH ADL ADL2 IADL IADL2 economic_support residence living visit_fren emotion_support \n         f10 age gender education job_type marriage_status hukou_type \n         social_insurance medical_insurance chronic_disease smoking drinking exercise\n         child_elderly_status care_support f103a3 f103b3 f103c3 f103d3 f103e3 f103f3 f103g3 f103h3 f103i3 f103j3 f103k3 f103l3 f103m3;\nrun;\n\n/* 将筛选后的保存为 XLSX 格式文件 */\n/*\nproc export data=selected_data\n    outfile='C:\\Users\\asus\\Desktop\\test\\CLHLS\\CLHLS数据\\CLHLS数据\\clhls_2018_sort0220.xlsx'\n    dbms=xlsx\n    replace;\nrun;\n*/\n\n/*检查f10 生育子女数的分布情况*/\nproc freq data=selected_data;\n    tables f10;\nrun;\n\n/*检查子女存活状态*/\nproc freq data=selected_data;\n    tables f103a3 f103b3 f103c3 f103d3 f103e3 f103f3 f103g3 f103h3 f103i3 f103j3 f103k3 f103l3 f103m3;\nrun;\n\n/* 样本筛选 */\ndata temp_data;\n    set selected_data;\n\n    /* 纳入标准 */\n    /* 年龄要求 */\n    /*age_include = (age &gt; 60);*/\n    /* 生育情况 */\n    fertility_include = (f10 &gt; 0);\n\n    /* 子女存活情况 */\n    array child_alive(*) f103a3 f103b3 f103c3 f103d3 f103e3 f103f3 f103g3 f103h3 f103i3 f103j3 f103k3 f103l3 f103m3;\n    child_alive_include = 0;\n    do i = 1 to dim(child_alive);\n        if child_alive[i] = 1 then do;\n            child_alive_include = 1;\n            leave;\n        end;\n    end;\n    meet_include = fertility_include and child_alive_include;\n\n    /* 排除标准 */ \n    /* 关键变量缺失值检查 */\n    /*array key_vars(*) SHEALTH ADL IADL;*/\n    array key_vars(*) SHEALTH ADL ADL2 IADL IADL2 economic_support residence living visit_fren emotion_support \n                      age gender education job_type marriage_status hukou_type \n                      social_insurance medical_insurance chronic_disease smoking drinking exercise\n                      child_elderly_status care_support;\n    has_missing = 0;\n    do i = 1 to dim(key_vars);\n        if missing(key_vars[i]) then do;\n            has_missing = 1;\n            leave;\n        end;\n    end;\n    /* 不合理生育数量检查 */\n    unreasonable_fertility = (f10 &gt; 7 or missing(f10));\n    meet_exclude = has_missing or unreasonable_fertility;\n\n    /* 筛选符合条件的样本 */\n    if meet_include and not meet_exclude;\n\n\n    /* 移除临时判断变量 */\n    drop fertility_include child_alive_include has_missing unreasonable_fertility meet_include meet_exclude;\n    /*移除部分原始变量*/\n    drop f103a3 f103b3 f103c3 f103d3 f103e3 f103f3 f103g3 f103h3 f103i3 f103j3 f103k3 f103l3 f103m3;\nrun;\n\n/*打印所有变量的频数分布表，检查是否含有异常值*/\n/*\nproc freq data=final_data;\n    tables _all_;\nrun;\n*/\n\n/*还需要删除含有的样本，即某些变量中赋值为9（not applicable）和88（don't know）的样本*/\n/*具体需要剔除变量满足这些条件的样本：SHEALTH&gt;8,ADL&gt;18,IADL&gt;24,residence&gt;3,eudcation&gt;22,smoking&gt;2,drinking&gt;2*/\n/* 删除满足特定条件的样本 */\ndata final_data;\n    set temp_data;\n    if (SHEALTH &lt;= 8) and (ADL &lt;= 18) and (IADL &lt;= 24) and (residence &lt;= 3) and (age&gt;=60) and (education &lt;= 22) and (smoking &lt;= 2) and (drinking &lt;= 2);\nrun;\n\nproc freq data=final_data;\n    tables _all_;\nrun;\n\n/* 保存筛选后的数据为 XLSX 格式 */\nproc export\n    data = final_data\n    outfile = 'C:\\Users\\asus\\Desktop\\test\\CLHLS\\Analysis-0214\\final_data.xlsx' /* 请替换为实际保存路径 */\n    dbms = xlsx\n    replace;\nrun;\n\n/* 对 age 变量进行分组 */\ndata final_data_grouped;\n    set final_data;\n    if age &lt; 70 then age_group = '60 - 69';\n    else if age &lt; 80 then age_group = '70 - 79';\n    else if age &lt; 90 then age_group = '80 - 89';\n    else age_group = '90+';\nrun;\n\n/* 探查每个变量的基本统计信息，查看是否有异常值 */\nproc means data=final_data n nmiss min max mean std;\n    var SHEALTH ADL ADL2 IADL IADL2 economic_support residence living visit_fren emotion_support\n        age gender education job_type marriage_status hukou_type\n        social_insurance medical_insurance chronic_disease smoking drinking exercise\n        child_elderly_status care_support;\nrun;\n\n/* 查看字符型变量的唯一值，看是否有异常字符 */\nproc freq data=final_data_grouped;\n    tables age_group gender education job_type marriage_status hukou_type;\nrun;\n\n/* 打印因变量、自变量和控制变量的频数分布表并汇总 */\nproc freq data=final_data_grouped noprint;\n    tables SHEALTH ADL ADL2 IADL IADL2 economic_support residence living visit_fren emotion_support\n           age_group gender education job_type marriage_status hukou_type\n           social_insurance medical_insurance chronic_disease smoking drinking exercise\n           child_elderly_status care_support / out=freq_summary;\nrun;\n\n/* 导出频数汇总表到 Excel */\nproc export\n    data = freq_summary\n    outfile = 'C:\\Users\\asus\\Desktop\\test\\CLHLS\\Analysis-0214\\frequency_summary.xlsx' /* 请替换为实际保存路径 */\n    dbms = xlsx\n    replace;\nrun;"
  }
]