{
  "hash": "a2529e83ddb9922e0e85acafba57af82",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"05-ggplot2 绘图——散点图\"\nauthor: \"Simonzhou\"\ndate: \"2025-07-25\"\ndate-modified: today\nformat: \n    html:\n        code-fold: true\n        code-line-numbers: true\n        code-highlight: true\n        fig_caption: true\n        number-sections: true\n        toc: true\n        toc-depth: 3\n---\n\n\n\n\n\n# 散点图\n\n散点图常用来刻画两个连续变量之间的关系。\n\n绘制散点图时，数据集中的每一个观测值都由散点图中的一个点来表示。通常，人们还会向散点图中添加一条直线，以用来表示基于某些统计模型的预测值。当散点图中的数据趋势难以用肉眼识别时，这些直线对我们理解数据的特征很有帮助。\n\n当数据集很大时，散点图上的数据点会相互重叠，此时，很难在图上清楚地显示出所有的数据点。为了解决重叠的问题，我们可以先对数据进行汇总，再绘制散点图。\n\n## 绘制基本散点图\n\n使用 `geom_point()` 函数，分别映射一个变量到 x 和一个变量到 y。\n\n这里使用 `heightweight` 数据集，这是一个多列数据集，接下来的例子我们只用到其中两列。\n\n\n\n\n\n::: {.cell fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\n# load package\nlibrary(ggplot2)\nlibrary(gcookbook) # 加载gcookbook是为了使用heightweight数据集\nlibrary(dplyr)\n\n# 列出我们绘制散点图要用到的两列的标题\nheightweight %>% \n  select(ageYear, heightIn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    ageYear heightIn\n1     11.92     56.3\n2     12.92     62.3\n3     12.75     63.3\n4     13.42     59.0\n5     15.92     62.5\n6     14.25     62.5\n7     15.42     59.0\n8     11.83     56.5\n9     13.33     62.0\n10    11.67     53.8\n11    11.58     61.5\n12    14.83     61.5\n13    13.08     64.5\n14    12.42     58.3\n15    11.92     51.3\n16    12.08     58.8\n17    15.92     65.3\n18    12.50     59.5\n19    12.25     61.3\n20    15.00     63.3\n21    11.75     61.8\n22    11.67     53.5\n23    13.67     58.0\n24    14.67     61.3\n25    15.42     63.3\n26    13.83     61.5\n27    14.58     60.8\n28    15.00     59.0\n29    17.50     65.5\n30    12.17     56.3\n31    14.17     64.3\n32    13.50     58.0\n33    12.42     64.3\n34    11.58     57.5\n35    15.50     57.8\n36    16.42     61.5\n37    14.08     62.3\n38    14.75     61.8\n39    15.42     65.3\n40    15.17     58.3\n41    14.42     62.8\n42    13.83     59.3\n43    14.00     61.5\n44    14.08     62.0\n45    12.50     61.3\n46    15.33     62.3\n47    11.58     52.8\n48    12.25     59.8\n49    12.00     59.5\n50    14.75     61.3\n51    14.83     63.5\n52    16.42     64.8\n53    12.17     60.0\n54    12.08     59.0\n55    12.25     55.8\n56    12.08     57.8\n57    12.92     61.3\n58    13.92     62.3\n59    15.25     64.3\n60    11.92     55.5\n61    15.25     64.5\n62    15.42     60.0\n63    12.33     56.3\n64    12.25     58.3\n65    12.83     60.0\n66    13.00     54.5\n67    12.00     55.8\n68    12.83     62.8\n69    12.67     60.5\n70    15.92     63.3\n71    15.83     66.8\n72    11.67     60.0\n73    12.33     60.5\n74    15.75     64.3\n75    11.92     58.3\n76    14.83     66.5\n77    13.67     65.3\n78    13.08     60.5\n79    12.25     59.5\n80    12.33     59.0\n81    14.75     61.3\n82    14.25     61.5\n83    14.33     64.8\n84    15.83     56.8\n85    15.25     66.5\n86    11.92     61.5\n87    14.92     63.0\n88    15.50     57.0\n89    15.17     65.5\n90    15.17     62.0\n91    11.83     56.0\n92    13.75     61.3\n93    13.75     55.5\n94    12.83     61.0\n95    12.50     54.5\n96    12.92     66.0\n97    13.58     56.5\n98    11.75     56.0\n99    12.25     51.5\n100   17.50     62.0\n101   14.25     63.0\n102   13.92     61.0\n103   15.17     64.0\n104   12.00     61.0\n105   16.08     59.8\n106   11.75     61.3\n107   13.67     63.3\n108   15.50     63.5\n109   14.08     61.5\n110   14.58     60.3\n111   15.00     61.3\n112   13.75     64.8\n113   13.08     60.5\n114   12.00     57.3\n115   12.50     59.5\n116   12.50     60.8\n117   11.58     60.5\n118   15.75     67.0\n119   15.25     64.8\n120   12.25     50.5\n121   12.17     57.5\n122   13.33     60.5\n123   13.00     61.8\n124   14.42     61.3\n125   12.58     66.3\n126   11.75     53.3\n127   12.50     59.0\n128   13.67     57.8\n129   12.75     60.0\n130   17.17     68.3\n132   14.67     63.8\n133   14.67     65.0\n134   11.67     59.5\n135   15.42     66.0\n136   15.00     61.8\n137   12.17     57.3\n138   15.25     66.0\n139   11.67     56.5\n140   12.58     58.3\n141   12.58     61.0\n142   12.00     62.8\n143   13.33     59.3\n144   14.83     67.3\n145   16.08     66.3\n146   13.50     64.5\n147   13.67     60.5\n148   15.50     66.0\n149   11.92     57.5\n150   14.58     64.0\n151   14.58     68.0\n152   14.58     63.5\n153   14.42     69.0\n154   14.17     63.8\n155   14.50     66.0\n156   13.67     63.5\n157   12.00     59.5\n158   13.00     66.3\n159   12.42     57.0\n160   12.00     60.0\n161   12.25     57.0\n162   15.67     67.3\n163   14.08     62.0\n164   14.33     65.0\n165   12.50     59.5\n166   16.08     67.8\n167   13.08     58.0\n168   14.00     60.0\n169   11.67     58.5\n170   13.00     58.3\n171   13.00     61.5\n172   13.17     65.0\n173   15.33     66.5\n174   13.00     68.5\n175   12.00     57.0\n176   14.67     61.5\n177   14.00     66.5\n178   12.42     52.5\n179   11.83     55.0\n180   15.67     71.0\n181   16.92     66.5\n182   11.83     58.8\n183   15.75     66.3\n184   15.67     65.8\n185   16.67     71.0\n186   12.67     59.5\n187   14.50     69.8\n188   13.83     62.5\n189   12.08     56.5\n190   11.92     57.5\n191   13.58     65.3\n192   13.83     67.3\n193   15.17     67.0\n194   14.42     66.0\n195   12.92     61.8\n196   13.50     60.0\n197   14.75     63.0\n198   14.75     60.5\n199   14.58     65.5\n200   13.83     62.0\n201   12.50     59.0\n202   12.50     61.8\n203   15.67     63.3\n204   13.58     66.0\n205   14.25     61.8\n206   13.50     63.0\n207   11.75     57.5\n208   14.50     63.0\n209   11.83     56.0\n210   12.33     60.5\n211   11.67     56.8\n212   13.33     64.0\n213   12.00     60.0\n214   17.17     69.5\n215   13.25     63.3\n216   12.42     56.3\n217   16.08     72.0\n218   16.17     65.3\n219   12.67     60.8\n220   12.17     55.0\n221   11.58     55.0\n222   15.50     66.5\n223   13.42     56.8\n224   12.75     64.8\n225   16.33     64.5\n226   13.67     58.0\n227   13.25     62.8\n228   14.83     63.8\n229   12.75     57.8\n230   12.92     57.3\n231   14.83     63.5\n232   11.83     55.0\n233   13.67     66.5\n234   15.75     65.0\n235   13.67     61.5\n236   13.92     62.0\n237   12.58     59.3\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n#>     ageYear heightIn\n#> 1     11.92     56.3\n#> 2     12.92     62.3\n#> 3     12.75     63.3\n#>  ...<230 more rows>...\n#> 235   13.67     61.5\n#> 236   13.92     62.0\n#> 237   12.58     59.3\n\nggplot(heightweight, aes(x = ageYear, y = heightIn)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![基本散点图](05-ggplot2-scatter-plot_files/figure-html/fig5-1-1.png){width=672}\n:::\n:::\n\n\n\n\n\n通过设定形状（shape）参数可以在散点图中绘制点以外的形状。例如，我们常用空心圈 `shape=21`（图 @fig5-3 ）代替默认的实心圆 `shape=19`（图 @fig5-1 ）​。\n\n\n\n\n\n::: {.cell fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\n# load package\nlibrary(ggplot2)\nlibrary(gcookbook) # 加载gcookbook是为了使用heightweight数据集\nlibrary(dplyr)\n\n# 列出我们绘制散点图要用到的两列的标题\nheightweight %>% \n  select(ageYear, heightIn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    ageYear heightIn\n1     11.92     56.3\n2     12.92     62.3\n3     12.75     63.3\n4     13.42     59.0\n5     15.92     62.5\n6     14.25     62.5\n7     15.42     59.0\n8     11.83     56.5\n9     13.33     62.0\n10    11.67     53.8\n11    11.58     61.5\n12    14.83     61.5\n13    13.08     64.5\n14    12.42     58.3\n15    11.92     51.3\n16    12.08     58.8\n17    15.92     65.3\n18    12.50     59.5\n19    12.25     61.3\n20    15.00     63.3\n21    11.75     61.8\n22    11.67     53.5\n23    13.67     58.0\n24    14.67     61.3\n25    15.42     63.3\n26    13.83     61.5\n27    14.58     60.8\n28    15.00     59.0\n29    17.50     65.5\n30    12.17     56.3\n31    14.17     64.3\n32    13.50     58.0\n33    12.42     64.3\n34    11.58     57.5\n35    15.50     57.8\n36    16.42     61.5\n37    14.08     62.3\n38    14.75     61.8\n39    15.42     65.3\n40    15.17     58.3\n41    14.42     62.8\n42    13.83     59.3\n43    14.00     61.5\n44    14.08     62.0\n45    12.50     61.3\n46    15.33     62.3\n47    11.58     52.8\n48    12.25     59.8\n49    12.00     59.5\n50    14.75     61.3\n51    14.83     63.5\n52    16.42     64.8\n53    12.17     60.0\n54    12.08     59.0\n55    12.25     55.8\n56    12.08     57.8\n57    12.92     61.3\n58    13.92     62.3\n59    15.25     64.3\n60    11.92     55.5\n61    15.25     64.5\n62    15.42     60.0\n63    12.33     56.3\n64    12.25     58.3\n65    12.83     60.0\n66    13.00     54.5\n67    12.00     55.8\n68    12.83     62.8\n69    12.67     60.5\n70    15.92     63.3\n71    15.83     66.8\n72    11.67     60.0\n73    12.33     60.5\n74    15.75     64.3\n75    11.92     58.3\n76    14.83     66.5\n77    13.67     65.3\n78    13.08     60.5\n79    12.25     59.5\n80    12.33     59.0\n81    14.75     61.3\n82    14.25     61.5\n83    14.33     64.8\n84    15.83     56.8\n85    15.25     66.5\n86    11.92     61.5\n87    14.92     63.0\n88    15.50     57.0\n89    15.17     65.5\n90    15.17     62.0\n91    11.83     56.0\n92    13.75     61.3\n93    13.75     55.5\n94    12.83     61.0\n95    12.50     54.5\n96    12.92     66.0\n97    13.58     56.5\n98    11.75     56.0\n99    12.25     51.5\n100   17.50     62.0\n101   14.25     63.0\n102   13.92     61.0\n103   15.17     64.0\n104   12.00     61.0\n105   16.08     59.8\n106   11.75     61.3\n107   13.67     63.3\n108   15.50     63.5\n109   14.08     61.5\n110   14.58     60.3\n111   15.00     61.3\n112   13.75     64.8\n113   13.08     60.5\n114   12.00     57.3\n115   12.50     59.5\n116   12.50     60.8\n117   11.58     60.5\n118   15.75     67.0\n119   15.25     64.8\n120   12.25     50.5\n121   12.17     57.5\n122   13.33     60.5\n123   13.00     61.8\n124   14.42     61.3\n125   12.58     66.3\n126   11.75     53.3\n127   12.50     59.0\n128   13.67     57.8\n129   12.75     60.0\n130   17.17     68.3\n132   14.67     63.8\n133   14.67     65.0\n134   11.67     59.5\n135   15.42     66.0\n136   15.00     61.8\n137   12.17     57.3\n138   15.25     66.0\n139   11.67     56.5\n140   12.58     58.3\n141   12.58     61.0\n142   12.00     62.8\n143   13.33     59.3\n144   14.83     67.3\n145   16.08     66.3\n146   13.50     64.5\n147   13.67     60.5\n148   15.50     66.0\n149   11.92     57.5\n150   14.58     64.0\n151   14.58     68.0\n152   14.58     63.5\n153   14.42     69.0\n154   14.17     63.8\n155   14.50     66.0\n156   13.67     63.5\n157   12.00     59.5\n158   13.00     66.3\n159   12.42     57.0\n160   12.00     60.0\n161   12.25     57.0\n162   15.67     67.3\n163   14.08     62.0\n164   14.33     65.0\n165   12.50     59.5\n166   16.08     67.8\n167   13.08     58.0\n168   14.00     60.0\n169   11.67     58.5\n170   13.00     58.3\n171   13.00     61.5\n172   13.17     65.0\n173   15.33     66.5\n174   13.00     68.5\n175   12.00     57.0\n176   14.67     61.5\n177   14.00     66.5\n178   12.42     52.5\n179   11.83     55.0\n180   15.67     71.0\n181   16.92     66.5\n182   11.83     58.8\n183   15.75     66.3\n184   15.67     65.8\n185   16.67     71.0\n186   12.67     59.5\n187   14.50     69.8\n188   13.83     62.5\n189   12.08     56.5\n190   11.92     57.5\n191   13.58     65.3\n192   13.83     67.3\n193   15.17     67.0\n194   14.42     66.0\n195   12.92     61.8\n196   13.50     60.0\n197   14.75     63.0\n198   14.75     60.5\n199   14.58     65.5\n200   13.83     62.0\n201   12.50     59.0\n202   12.50     61.8\n203   15.67     63.3\n204   13.58     66.0\n205   14.25     61.8\n206   13.50     63.0\n207   11.75     57.5\n208   14.50     63.0\n209   11.83     56.0\n210   12.33     60.5\n211   11.67     56.8\n212   13.33     64.0\n213   12.00     60.0\n214   17.17     69.5\n215   13.25     63.3\n216   12.42     56.3\n217   16.08     72.0\n218   16.17     65.3\n219   12.67     60.8\n220   12.17     55.0\n221   11.58     55.0\n222   15.50     66.5\n223   13.42     56.8\n224   12.75     64.8\n225   16.33     64.5\n226   13.67     58.0\n227   13.25     62.8\n228   14.83     63.8\n229   12.75     57.8\n230   12.92     57.3\n231   14.83     63.5\n232   11.83     55.0\n233   13.67     66.5\n234   15.75     65.0\n235   13.67     61.5\n236   13.92     62.0\n237   12.58     59.3\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(heightweight, aes(x = ageYear, y = heightIn)) + \n  geom_point(shape = 21)\n```\n\n::: {.cell-output-display}\n![基本散点图-修改形状](05-ggplot2-scatter-plot_files/figure-html/fig5-2-1.png){width=672}\n:::\n:::\n\n\n\n\n\n修改点的大小（在默认实心圆点的情况下），默认点的大小为：`size=2`。\n\n\n\n\n\n::: {.cell fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\n# load package\nlibrary(ggplot2)\nlibrary(gcookbook) # 加载gcookbook是为了使用heightweight数据集\nlibrary(dplyr)\n\n# 列出我们绘制散点图要用到的两列的标题\nheightweight %>% \n  select(ageYear, heightIn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    ageYear heightIn\n1     11.92     56.3\n2     12.92     62.3\n3     12.75     63.3\n4     13.42     59.0\n5     15.92     62.5\n6     14.25     62.5\n7     15.42     59.0\n8     11.83     56.5\n9     13.33     62.0\n10    11.67     53.8\n11    11.58     61.5\n12    14.83     61.5\n13    13.08     64.5\n14    12.42     58.3\n15    11.92     51.3\n16    12.08     58.8\n17    15.92     65.3\n18    12.50     59.5\n19    12.25     61.3\n20    15.00     63.3\n21    11.75     61.8\n22    11.67     53.5\n23    13.67     58.0\n24    14.67     61.3\n25    15.42     63.3\n26    13.83     61.5\n27    14.58     60.8\n28    15.00     59.0\n29    17.50     65.5\n30    12.17     56.3\n31    14.17     64.3\n32    13.50     58.0\n33    12.42     64.3\n34    11.58     57.5\n35    15.50     57.8\n36    16.42     61.5\n37    14.08     62.3\n38    14.75     61.8\n39    15.42     65.3\n40    15.17     58.3\n41    14.42     62.8\n42    13.83     59.3\n43    14.00     61.5\n44    14.08     62.0\n45    12.50     61.3\n46    15.33     62.3\n47    11.58     52.8\n48    12.25     59.8\n49    12.00     59.5\n50    14.75     61.3\n51    14.83     63.5\n52    16.42     64.8\n53    12.17     60.0\n54    12.08     59.0\n55    12.25     55.8\n56    12.08     57.8\n57    12.92     61.3\n58    13.92     62.3\n59    15.25     64.3\n60    11.92     55.5\n61    15.25     64.5\n62    15.42     60.0\n63    12.33     56.3\n64    12.25     58.3\n65    12.83     60.0\n66    13.00     54.5\n67    12.00     55.8\n68    12.83     62.8\n69    12.67     60.5\n70    15.92     63.3\n71    15.83     66.8\n72    11.67     60.0\n73    12.33     60.5\n74    15.75     64.3\n75    11.92     58.3\n76    14.83     66.5\n77    13.67     65.3\n78    13.08     60.5\n79    12.25     59.5\n80    12.33     59.0\n81    14.75     61.3\n82    14.25     61.5\n83    14.33     64.8\n84    15.83     56.8\n85    15.25     66.5\n86    11.92     61.5\n87    14.92     63.0\n88    15.50     57.0\n89    15.17     65.5\n90    15.17     62.0\n91    11.83     56.0\n92    13.75     61.3\n93    13.75     55.5\n94    12.83     61.0\n95    12.50     54.5\n96    12.92     66.0\n97    13.58     56.5\n98    11.75     56.0\n99    12.25     51.5\n100   17.50     62.0\n101   14.25     63.0\n102   13.92     61.0\n103   15.17     64.0\n104   12.00     61.0\n105   16.08     59.8\n106   11.75     61.3\n107   13.67     63.3\n108   15.50     63.5\n109   14.08     61.5\n110   14.58     60.3\n111   15.00     61.3\n112   13.75     64.8\n113   13.08     60.5\n114   12.00     57.3\n115   12.50     59.5\n116   12.50     60.8\n117   11.58     60.5\n118   15.75     67.0\n119   15.25     64.8\n120   12.25     50.5\n121   12.17     57.5\n122   13.33     60.5\n123   13.00     61.8\n124   14.42     61.3\n125   12.58     66.3\n126   11.75     53.3\n127   12.50     59.0\n128   13.67     57.8\n129   12.75     60.0\n130   17.17     68.3\n132   14.67     63.8\n133   14.67     65.0\n134   11.67     59.5\n135   15.42     66.0\n136   15.00     61.8\n137   12.17     57.3\n138   15.25     66.0\n139   11.67     56.5\n140   12.58     58.3\n141   12.58     61.0\n142   12.00     62.8\n143   13.33     59.3\n144   14.83     67.3\n145   16.08     66.3\n146   13.50     64.5\n147   13.67     60.5\n148   15.50     66.0\n149   11.92     57.5\n150   14.58     64.0\n151   14.58     68.0\n152   14.58     63.5\n153   14.42     69.0\n154   14.17     63.8\n155   14.50     66.0\n156   13.67     63.5\n157   12.00     59.5\n158   13.00     66.3\n159   12.42     57.0\n160   12.00     60.0\n161   12.25     57.0\n162   15.67     67.3\n163   14.08     62.0\n164   14.33     65.0\n165   12.50     59.5\n166   16.08     67.8\n167   13.08     58.0\n168   14.00     60.0\n169   11.67     58.5\n170   13.00     58.3\n171   13.00     61.5\n172   13.17     65.0\n173   15.33     66.5\n174   13.00     68.5\n175   12.00     57.0\n176   14.67     61.5\n177   14.00     66.5\n178   12.42     52.5\n179   11.83     55.0\n180   15.67     71.0\n181   16.92     66.5\n182   11.83     58.8\n183   15.75     66.3\n184   15.67     65.8\n185   16.67     71.0\n186   12.67     59.5\n187   14.50     69.8\n188   13.83     62.5\n189   12.08     56.5\n190   11.92     57.5\n191   13.58     65.3\n192   13.83     67.3\n193   15.17     67.0\n194   14.42     66.0\n195   12.92     61.8\n196   13.50     60.0\n197   14.75     63.0\n198   14.75     60.5\n199   14.58     65.5\n200   13.83     62.0\n201   12.50     59.0\n202   12.50     61.8\n203   15.67     63.3\n204   13.58     66.0\n205   14.25     61.8\n206   13.50     63.0\n207   11.75     57.5\n208   14.50     63.0\n209   11.83     56.0\n210   12.33     60.5\n211   11.67     56.8\n212   13.33     64.0\n213   12.00     60.0\n214   17.17     69.5\n215   13.25     63.3\n216   12.42     56.3\n217   16.08     72.0\n218   16.17     65.3\n219   12.67     60.8\n220   12.17     55.0\n221   11.58     55.0\n222   15.50     66.5\n223   13.42     56.8\n224   12.75     64.8\n225   16.33     64.5\n226   13.67     58.0\n227   13.25     62.8\n228   14.83     63.8\n229   12.75     57.8\n230   12.92     57.3\n231   14.83     63.5\n232   11.83     55.0\n233   13.67     66.5\n234   15.75     65.0\n235   13.67     61.5\n236   13.92     62.0\n237   12.58     59.3\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(heightweight, aes(x = ageYear, y = heightIn)) + \n  geom_point(size = 1.5)\n```\n\n::: {.cell-output-display}\n![基本散点图-修改散点大小](05-ggplot2-scatter-plot_files/figure-html/fig5-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## 使用点形或颜色属性对数据点进行分组\n\n将分组变量映射到点形（`shape`）或颜色（`colour`）属性。\n\n接下来的例子中，我们将用到 `heightweight` 数据集中的3列。\n\n\n\n\n\n::: {.cell .column-page-right layout-ncol=\"2\" fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\n# load package\nlibrary(ggplot2)\nlibrary(gcookbook) # 加载gcookbook是为了使用heightweight数据集\nlibrary(dplyr)\n\n# 列出要用到的3列的标题\nheightweight %>%\n  select(sex, ageYear, heightIn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    sex ageYear heightIn\n1     f   11.92     56.3\n2     f   12.92     62.3\n3     f   12.75     63.3\n4     f   13.42     59.0\n5     f   15.92     62.5\n6     f   14.25     62.5\n7     f   15.42     59.0\n8     f   11.83     56.5\n9     f   13.33     62.0\n10    f   11.67     53.8\n11    f   11.58     61.5\n12    f   14.83     61.5\n13    f   13.08     64.5\n14    f   12.42     58.3\n15    f   11.92     51.3\n16    f   12.08     58.8\n17    f   15.92     65.3\n18    f   12.50     59.5\n19    f   12.25     61.3\n20    f   15.00     63.3\n21    f   11.75     61.8\n22    f   11.67     53.5\n23    f   13.67     58.0\n24    f   14.67     61.3\n25    f   15.42     63.3\n26    f   13.83     61.5\n27    f   14.58     60.8\n28    f   15.00     59.0\n29    f   17.50     65.5\n30    f   12.17     56.3\n31    f   14.17     64.3\n32    f   13.50     58.0\n33    f   12.42     64.3\n34    f   11.58     57.5\n35    f   15.50     57.8\n36    f   16.42     61.5\n37    f   14.08     62.3\n38    f   14.75     61.8\n39    f   15.42     65.3\n40    f   15.17     58.3\n41    f   14.42     62.8\n42    f   13.83     59.3\n43    f   14.00     61.5\n44    f   14.08     62.0\n45    f   12.50     61.3\n46    f   15.33     62.3\n47    f   11.58     52.8\n48    f   12.25     59.8\n49    f   12.00     59.5\n50    f   14.75     61.3\n51    f   14.83     63.5\n52    f   16.42     64.8\n53    f   12.17     60.0\n54    f   12.08     59.0\n55    f   12.25     55.8\n56    f   12.08     57.8\n57    f   12.92     61.3\n58    f   13.92     62.3\n59    f   15.25     64.3\n60    f   11.92     55.5\n61    f   15.25     64.5\n62    f   15.42     60.0\n63    f   12.33     56.3\n64    f   12.25     58.3\n65    f   12.83     60.0\n66    f   13.00     54.5\n67    f   12.00     55.8\n68    f   12.83     62.8\n69    f   12.67     60.5\n70    f   15.92     63.3\n71    f   15.83     66.8\n72    f   11.67     60.0\n73    f   12.33     60.5\n74    f   15.75     64.3\n75    f   11.92     58.3\n76    f   14.83     66.5\n77    f   13.67     65.3\n78    f   13.08     60.5\n79    f   12.25     59.5\n80    f   12.33     59.0\n81    f   14.75     61.3\n82    f   14.25     61.5\n83    f   14.33     64.8\n84    f   15.83     56.8\n85    f   15.25     66.5\n86    f   11.92     61.5\n87    f   14.92     63.0\n88    f   15.50     57.0\n89    f   15.17     65.5\n90    f   15.17     62.0\n91    f   11.83     56.0\n92    f   13.75     61.3\n93    f   13.75     55.5\n94    f   12.83     61.0\n95    f   12.50     54.5\n96    f   12.92     66.0\n97    f   13.58     56.5\n98    f   11.75     56.0\n99    f   12.25     51.5\n100   f   17.50     62.0\n101   f   14.25     63.0\n102   f   13.92     61.0\n103   f   15.17     64.0\n104   f   12.00     61.0\n105   f   16.08     59.8\n106   f   11.75     61.3\n107   f   13.67     63.3\n108   f   15.50     63.5\n109   f   14.08     61.5\n110   f   14.58     60.3\n111   f   15.00     61.3\n112   m   13.75     64.8\n113   m   13.08     60.5\n114   m   12.00     57.3\n115   m   12.50     59.5\n116   m   12.50     60.8\n117   m   11.58     60.5\n118   m   15.75     67.0\n119   m   15.25     64.8\n120   m   12.25     50.5\n121   m   12.17     57.5\n122   m   13.33     60.5\n123   m   13.00     61.8\n124   m   14.42     61.3\n125   m   12.58     66.3\n126   m   11.75     53.3\n127   m   12.50     59.0\n128   m   13.67     57.8\n129   m   12.75     60.0\n130   m   17.17     68.3\n132   m   14.67     63.8\n133   m   14.67     65.0\n134   m   11.67     59.5\n135   m   15.42     66.0\n136   m   15.00     61.8\n137   m   12.17     57.3\n138   m   15.25     66.0\n139   m   11.67     56.5\n140   m   12.58     58.3\n141   m   12.58     61.0\n142   m   12.00     62.8\n143   m   13.33     59.3\n144   m   14.83     67.3\n145   m   16.08     66.3\n146   m   13.50     64.5\n147   m   13.67     60.5\n148   m   15.50     66.0\n149   m   11.92     57.5\n150   m   14.58     64.0\n151   m   14.58     68.0\n152   m   14.58     63.5\n153   m   14.42     69.0\n154   m   14.17     63.8\n155   m   14.50     66.0\n156   m   13.67     63.5\n157   m   12.00     59.5\n158   m   13.00     66.3\n159   m   12.42     57.0\n160   m   12.00     60.0\n161   m   12.25     57.0\n162   m   15.67     67.3\n163   m   14.08     62.0\n164   m   14.33     65.0\n165   m   12.50     59.5\n166   m   16.08     67.8\n167   m   13.08     58.0\n168   m   14.00     60.0\n169   m   11.67     58.5\n170   m   13.00     58.3\n171   m   13.00     61.5\n172   m   13.17     65.0\n173   m   15.33     66.5\n174   m   13.00     68.5\n175   m   12.00     57.0\n176   m   14.67     61.5\n177   m   14.00     66.5\n178   m   12.42     52.5\n179   m   11.83     55.0\n180   m   15.67     71.0\n181   m   16.92     66.5\n182   m   11.83     58.8\n183   m   15.75     66.3\n184   m   15.67     65.8\n185   m   16.67     71.0\n186   m   12.67     59.5\n187   m   14.50     69.8\n188   m   13.83     62.5\n189   m   12.08     56.5\n190   m   11.92     57.5\n191   m   13.58     65.3\n192   m   13.83     67.3\n193   m   15.17     67.0\n194   m   14.42     66.0\n195   m   12.92     61.8\n196   m   13.50     60.0\n197   m   14.75     63.0\n198   m   14.75     60.5\n199   m   14.58     65.5\n200   m   13.83     62.0\n201   m   12.50     59.0\n202   m   12.50     61.8\n203   m   15.67     63.3\n204   m   13.58     66.0\n205   m   14.25     61.8\n206   m   13.50     63.0\n207   m   11.75     57.5\n208   m   14.50     63.0\n209   m   11.83     56.0\n210   m   12.33     60.5\n211   m   11.67     56.8\n212   m   13.33     64.0\n213   m   12.00     60.0\n214   m   17.17     69.5\n215   m   13.25     63.3\n216   m   12.42     56.3\n217   m   16.08     72.0\n218   m   16.17     65.3\n219   m   12.67     60.8\n220   m   12.17     55.0\n221   m   11.58     55.0\n222   m   15.50     66.5\n223   m   13.42     56.8\n224   m   12.75     64.8\n225   m   16.33     64.5\n226   m   13.67     58.0\n227   m   13.25     62.8\n228   m   14.83     63.8\n229   m   12.75     57.8\n230   m   12.92     57.3\n231   m   14.83     63.5\n232   m   11.83     55.0\n233   m   13.67     66.5\n234   m   15.75     65.0\n235   m   13.67     61.5\n236   m   13.92     62.0\n237   m   12.58     59.3\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n#>     sex ageYear heightIn\n#> 1     f   11.92     56.3\n#> 2     f   12.92     62.3\n#> 3     f   12.75     63.3\n#>  ...<230 more rows>...\n#> 235   m   13.67     61.5\n#> 236   m   13.92     62.0\n#> 237   m   12.58     59.3\n\nggplot(heightweight, aes(x = ageYear, y = heightIn,color = sex)) + \n  geom_point()\n\nggplot(heightweight, aes(x = ageYear, y = heightIn,shape = sex)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![按颜色分组](05-ggplot2-scatter-plot_files/figure-html/fig5-4-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![按形状分组](05-ggplot2-scatter-plot_files/figure-html/fig5-4-2.png){width=672}\n:::\n\n基本散点图-按形/色分组\n:::\n\n\n\n\n\n选用的分组变量必须是分类变量，换言之，它必须是因子型或者字符型的向量。如果分组变量是数值型向量，则需要将它转化为因子型变量之后，才能以其作为分组变量。\n\n可以将一个变量同时映射到 `shape` 和 `colour` 属性。当有多个分组变量时，可以将它们分别映射到不同的图形属性。下面，我们把变量 `sex` 同时映射到 `shape` 和 `colour` 属性，见图 @fig5-5 。\n\n\n\n\n\n::: {.cell fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(heightweight, aes(x = ageYear, y = heightIn,color = sex,shape = sex)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![基本散点图-按形和色分组](05-ggplot2-scatter-plot_files/figure-html/fig5-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n有时需要使用不同于默认设置的点形和颜色。通过调用`scale_shape_manual()` 函数可以使用其他点形；\n\n调用 `scale_colour_brewer()` 函数或者 `scale_colour_manual()` 函数可以使用其他调色板，见图 @fig5-6 。\n\n\n\n\n\n::: {.cell fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(heightweight, aes(x = ageYear, y = heightIn, shape = sex, colour = sex)) + \n  geom_point() +\n  scale_shape_manual(values = c(1,2)) + \n  scale_colour_brewer(palette = \"Set1\")\n```\n\n::: {.cell-output-display}\n![基本散点图-修改调色板](05-ggplot2-scatter-plot_files/figure-html/fig5-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## 使用不同于默认设置的点形\n\n通过指定 `geom_point()` 函数中的点形（`shape`）参数，可以同时设定散点图中所有数据点的点形，如图 @fig5-7 所示。\n\n\n\n\n\n::: {.cell fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(heightweight, aes(x = ageYear, y = heightIn)) + \n  geom_point(shape = 3)\n```\n\n::: {.cell-output-display}\n![指定散点形状](05-ggplot2-scatter-plot_files/figure-html/fig5-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\nR系统绘图可以调用的图形较多，一些点形只有边框线（1～14）​；一些只有实心填充区域（15～20）​；还有一些则由可分离的边框线和具有填充色的实心区域共同组成（21～25）​，也可以用字符作点形。\n\n如果已将分组变量映射到 `shape`，则可以调用 `scale_shape_manual()` 函数来手动修改该分组变量不同水平的点形\n\n下图将使用略大且自定义点形的数据点：\n\n\n\n\n\n::: {.cell fig='true'}\n\n```{.r .cell-code  code-fold=\"false\"}\nggplot(heightweight, aes(x = ageYear, y = heightIn, shape = sex)) + \n  geom_point(size = 3)+\n  scale_shape_manual(values = c(1,4))\n```\n\n::: {.cell-output-display}\n![自定义散点形状](05-ggplot2-scatter-plot_files/figure-html/fig5-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n-   点形1～20的点的颜色，包括实心区域的颜色都可由 `colour` 参数来控制。\n\n-   对于点形21～25而言，边框线和实心区域的颜色则分别由 `colour` 和 `fill` 参数来控制。\n\n我们可以将两个不同的变量分别由点形和填充色（空心或有填充）属性来表示。\n\n为了实现这一功能，首先需要选择一个同时具有 `colour` 和 `fill` 属性的点形，在 `scale_shape_manual` 中设定。之后需要在`scale_fill_manual()` 中选择一个包括 NA 和其他颜色的调色板（NA会生成一个空心的形状）​。",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}